
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Brotherc">
    <title>标签: 加密 - Brotherc</title>
    <meta name="author" content="Brotherc">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Brotherc">
<meta property="og:url" content="http://yoursite.com/tags/加密/index.html">
<meta property="og:site_name" content="Brotherc">
<meta property="og:locale" content="zh-cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Brotherc">
    
    
        
    
    
        <meta property="og:image" content="http://yoursite.com/assets/images/head.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-c4ozcsklz4kht2pebhp44xorvyverh23toayhn7i6ubrpyedak24hv1v0hyd.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Brotherc</a>
    </div>
    
        
            <a class="header-right-picture " href="#about">
        
        
            <img class="header-picture" src="/assets/images/head.jpg" alt="作者的图片">
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/head.jpg" alt="作者的图片">
                </a>
                <h4 class="sidebar-profile-name">Brotherc</h4>
                
                    <h5 class="sidebar-profile-bio"><p>java development</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/ " title="首页">
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" title="分类">
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" title="标签">
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link open-algolia-search" href="/all-archives" title="归档">
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" title="关于">
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/Brotherc" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2020/08/19/JAVA实现对称加密/">
                            JAVA实现对称加密
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-08-19T11:57:40+08:00">
	
		    8月 19, 2020
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="Java实现Base64加密"><a href="#Java实现Base64加密" class="headerlink" title="Java实现Base64加密"></a>Java实现Base64加密</h2><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/1.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/1.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/2.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/2.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/3.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/3.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/4.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/4.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/5.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/5.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/6.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/6.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/7.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/7.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/8.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/8.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/9.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/9.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/10.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/10.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/11.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/11.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/12.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/12.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/13.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/13.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/14.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/14.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/15.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/15.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/16.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/16.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;</span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Base64Test</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"base64 test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkBase64();</span><br><span class="line">		</span><br><span class="line">		commonsCodesBase64();</span><br><span class="line"></span><br><span class="line">		bouncyCastleBase64();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkBase64</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			BASE64Encoder encoder = <span class="keyword">new</span> BASE64Encoder();</span><br><span class="line">			String encode = encoder.encode(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"encode:"</span> + encode);</span><br><span class="line">			</span><br><span class="line">			BASE64Decoder decoder = <span class="keyword">new</span> BASE64Decoder();</span><br><span class="line">			System.out.println(<span class="string">"decode:"</span> + <span class="keyword">new</span> String(decoder.decodeBuffer(encode)));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用Apache的common codes实现</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">commonsCodesBase64</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">byte</span>[] encodeBytes = Base64.encodeBase64(src.getBytes());</span><br><span class="line">		System.out.println(<span class="string">"common codes encode:"</span> + <span class="keyword">new</span> String(encodeBytes));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] dencodeBytes = Base64.decodeBase64(encodeBytes);</span><br><span class="line">		System.out.println(<span class="string">"common codes decode:"</span> + <span class="keyword">new</span> String(dencodeBytes));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 用bouncy castle实现</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bouncyCastleBase64</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">byte</span>[] encodeBytes = org.bouncycastle.util.encoders.Base64.encode(src.getBytes());</span><br><span class="line">		System.out.println(<span class="string">"bouncy castle encode:"</span> + <span class="keyword">new</span> String(encodeBytes));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] dencodeBytes = org.bouncycastle.util.encoders.Base64.decode(encodeBytes);</span><br><span class="line">		System.out.println(<span class="string">"bouncy castle decode:"</span> + <span class="keyword">new</span> String(dencodeBytes));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/17.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/17.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/18.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/18.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<h2 id="Java实现消息摘要算法加密"><a href="#Java实现消息摘要算法加密" class="headerlink" title="Java实现消息摘要算法加密"></a>Java实现消息摘要算法加密</h2><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/28.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/28.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/29.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/29.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/30.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/30.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.digest.DigestUtils;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.MD4Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.MD5Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MD5Test</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"md5 test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkMD5();</span><br><span class="line">		jdkMD2();</span><br><span class="line">		</span><br><span class="line">		bcMD4();</span><br><span class="line">		bcMD5();</span><br><span class="line">		</span><br><span class="line">		bc2jdkMD4();</span><br><span class="line">		</span><br><span class="line">		ccMD5();</span><br><span class="line">		ccMD2();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:MD5</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">			<span class="keyword">byte</span>[] md5Bytes = md.digest(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"JDK MD5:"</span> + Hex.encodeHexString(md5Bytes));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:MD2</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkMD2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"MD2"</span>);</span><br><span class="line">			<span class="keyword">byte</span>[] md2Bytes = md.digest(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"JDK MD2:"</span> + Hex.encodeHexString(md2Bytes));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:MD5</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		MD5Digest digest = <span class="keyword">new</span> MD5Digest();</span><br><span class="line">		digest.update(src.getBytes(),<span class="number">0</span>,src.getBytes().length);</span><br><span class="line">		<span class="keyword">byte</span>[] md5Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[digest.getDigestSize()];</span><br><span class="line">		digest.doFinal(md5Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bouncy castle MD5:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(md5Bytes));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 用bouncy castle实现:MD4</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcMD4</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		MD4Digest digest = <span class="keyword">new</span> MD4Digest();</span><br><span class="line">		digest.update(src.getBytes(),<span class="number">0</span>,src.getBytes().length);</span><br><span class="line">		<span class="keyword">byte</span>[] md4Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[digest.getDigestSize()];</span><br><span class="line">		digest.doFinal(md4Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bouncy castle MD4:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(md4Bytes));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle与jdk结合实现:MD4</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bc2jdkMD4</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"MD4"</span>);</span><br><span class="line">			<span class="keyword">byte</span>[] md4Bytes = md.digest(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc and JDK MD4:"</span> + Hex.encodeHexString(md4Bytes));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用common codes实现实现:MD5</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ccMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"common codes MD5:"</span> + DigestUtils.md5Hex(src.getBytes()));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用common codes实现实现:MD2</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ccMD2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"common codes MD2:"</span> + DigestUtils.md2Hex(src.getBytes()));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/31.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/31.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/32.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/32.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.digest.DigestUtils;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.SHA1Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.SHA224Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SHATest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"sha test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkSHA1();</span><br><span class="line">		bcSHA1();</span><br><span class="line">		bcSHA224();</span><br><span class="line">		bcSHA224b();</span><br><span class="line">		generateSha256();</span><br><span class="line">		ccSHA1();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:SHA1</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkSHA1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"SHA"</span>);</span><br><span class="line">			md.update(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk sha-1:"</span> + Hex.encodeHexString(md.digest()));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:SHA1 </span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcSHA1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		</span><br><span class="line">		Digest digest = <span class="keyword">new</span> SHA1Digest();</span><br><span class="line">		digest.update(src.getBytes(), <span class="number">0</span>, src.getBytes().length );</span><br><span class="line">		<span class="keyword">byte</span>[] sha1Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[digest.getDigestSize()];</span><br><span class="line">		digest.doFinal(sha1Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bc sha-1:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(sha1Bytes));		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 用bouncy castle实现:SHA224 </span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcSHA224</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		</span><br><span class="line">		Digest digest = <span class="keyword">new</span> SHA224Digest();</span><br><span class="line">		digest.update(src.getBytes(), <span class="number">0</span>, src.getBytes().length );</span><br><span class="line">		<span class="keyword">byte</span>[] sha224Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[digest.getDigestSize()];</span><br><span class="line">		digest.doFinal(sha224Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bc sha-224:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(sha224Bytes));		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle与jdk结合实现:SHA224 </span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcSHA224b</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"SHA224"</span>);</span><br><span class="line">			md.update(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc and JDK sha-224:"</span> + Hex.encodeHexString(md.digest()));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">generateSha256</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		MessageDigest md = MessageDigest.getInstance(<span class="string">"SHA-256"</span>);</span><br><span class="line"></span><br><span class="line">        md.update(src.getBytes(<span class="string">"UTF-8"</span>)); <span class="comment">// Change this to "UTF-16" if needed</span></span><br><span class="line">        <span class="keyword">byte</span>[] digest = md.digest();</span><br><span class="line">        BigInteger bigInt = <span class="keyword">new</span> BigInteger(<span class="number">1</span>, digest);</span><br><span class="line">        System.out.println(<span class="string">"Sha256 hash: "</span> + bigInt.toString(<span class="number">16</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用common codes实现实现:SHA1</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ccSHA1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"common codes SHA1 - 1 :"</span> + DigestUtils.sha1Hex(src.getBytes()));</span><br><span class="line">		System.out.println(<span class="string">"common codes SHA1 - 2 :"</span> + DigestUtils.sha1Hex(src));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/33.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/33.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/34.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/34.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/35.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/35.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/36.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/36.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Mac;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.MD5Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.macs.HMac;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.params.KeyParameter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HMACTest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"hmac test"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkHmacMD5();</span><br><span class="line">		bcHmacMD5();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkHmacMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 初始化KeyGenerator</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"HmacMD5"</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line"><span class="comment">//			byte[] key = secretKey.getEncoded();</span></span><br><span class="line">			<span class="keyword">byte</span>[] key = Hex.decodeHex(<span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span> &#125;);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 还原密钥</span></span><br><span class="line">			SecretKey restoreSecretKey = <span class="keyword">new</span> SecretKeySpec(key, <span class="string">"HmacMD5"</span>);</span><br><span class="line">			<span class="comment">// 实例化MAC</span></span><br><span class="line">			Mac mac = Mac.getInstance(restoreSecretKey.getAlgorithm());</span><br><span class="line">			<span class="comment">// 初始化MAC</span></span><br><span class="line">			mac.init(restoreSecretKey);</span><br><span class="line">			<span class="comment">// 执行摘要</span></span><br><span class="line">			<span class="keyword">byte</span>[] hmacMD5Bytes = mac.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk hmacMD5:"</span> + Hex.encodeHexString(hmacMD5Bytes));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcHmacMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		HMac hmac = <span class="keyword">new</span> HMac(<span class="keyword">new</span> MD5Digest());</span><br><span class="line">		<span class="comment">// 必须是16进制的字符，长度必须是2的倍数</span></span><br><span class="line">		hmac.init(<span class="keyword">new</span> KeyParameter(org.bouncycastle.util.encoders.Hex.decode(<span class="string">"123456789abcde"</span>)));</span><br><span class="line">		hmac.update(src.getBytes(), <span class="number">0</span>, src.getBytes().length);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 执行摘要</span></span><br><span class="line">		<span class="keyword">byte</span>[] hmacMD5Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[hmac.getMacSize()];</span><br><span class="line">		hmac.doFinal(hmacMD5Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bc hmacMD5:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(hmacMD5Bytes));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/37.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/37.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/38.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/38.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<h2 id="Java实现对称加密"><a href="#Java实现对称加密" class="headerlink" title="Java实现对称加密"></a>Java实现对称加密</h2><ul>
<li>软件、硬件</li>
<li>加密密钥=解密密钥</li>
<li>初等、DES(3DES)、AES、PBE、IDEA</li>
</ul>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/19.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/19.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DESTest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"des test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkDES();</span><br><span class="line">		bcDES();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkDES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"DES"</span>);			</span><br><span class="line">			keyGenerator.init(<span class="number">56</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] bytesKey = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			DESKeySpec desKeySpec = <span class="keyword">new</span> DESKeySpec(bytesKey);</span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">			Key convertSecretKey = factory.generateSecret(desKeySpec);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DES/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk des encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, convertSecretKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"jdk des decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcDES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"DES"</span>, <span class="string">"BC"</span>);</span><br><span class="line">			keyGenerator.getProvider();</span><br><span class="line">			keyGenerator.init(<span class="number">56</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] bytesKey = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			DESKeySpec desKeySpec = <span class="keyword">new</span> DESKeySpec(bytesKey);</span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">			Key convertSecretKey = factory.generateSecret(desKeySpec);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DES/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc des encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, convertSecretKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"bc des decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/20.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/20.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/21.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/21.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/22.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/22.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/23.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/23.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/24.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/24.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/25.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/25.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.SecureRandom;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESedeKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DES3Test</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"3des test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdk3DES();</span><br><span class="line">		bc3DES();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdk3DES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"DESede"</span>);	</span><br><span class="line">			<span class="comment">// 必须长度是：112或168</span></span><br><span class="line"><span class="comment">//			keyGenerator.init(168);</span></span><br><span class="line">			keyGenerator.init(<span class="keyword">new</span> SecureRandom());</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] bytesKey = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			DESedeKeySpec desKeySpec = <span class="keyword">new</span> DESedeKeySpec(bytesKey);</span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"DESede"</span>);</span><br><span class="line">			Key convertSecretKey = factory.generateSecret(desKeySpec);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DESede/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk 3des encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, convertSecretKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"jdk 3des decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bc3DES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"DESede"</span>, <span class="string">"BC"</span>);</span><br><span class="line">			keyGenerator.getProvider();</span><br><span class="line">			keyGenerator.init(<span class="number">168</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] bytesKey = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			DESedeKeySpec desKeySpec = <span class="keyword">new</span> DESedeKeySpec(bytesKey);</span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"DESede"</span>);</span><br><span class="line">			Key convertSecretKey = factory.generateSecret(desKeySpec);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DESede/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc 3des encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, convertSecretKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"bc 3des decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>AES是目前使用最多的对称加密算法</li>
<li>AES的优势之一是至今尚未被破解</li>
<li>AES通常用于移动通信系统加密以及基于SSH协议的软件(SSH Client、secureCRT)</li>
</ul>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/26.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/26.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AESTest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"aes test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkAES();</span><br><span class="line">		bcAES();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkAES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"AES"</span>);			</span><br><span class="line">			keyGenerator.init(<span class="number">128</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] keyBytes = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			Key key = <span class="keyword">new</span> SecretKeySpec(keyBytes, <span class="string">"AES"</span>);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"AES/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, key);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk aes encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"jdk aes decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcAES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"AES"</span>, <span class="string">"BC"</span>);	</span><br><span class="line">			keyGenerator.getProvider();</span><br><span class="line">			keyGenerator.init(<span class="number">128</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] keyBytes = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			Key key = <span class="keyword">new</span> SecretKeySpec(keyBytes, <span class="string">"AES"</span>);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"AES/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, key);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc aes encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"bc aes decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/27.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/27.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/39.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/39.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/40.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/40.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/41.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/41.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/42.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/42.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/43.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/43.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.SecureRandom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.PBEKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.PBEParameterSpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PBETest</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"pbe test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkPBE();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkPBE</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 初始化盐</span></span><br><span class="line">			SecureRandom random = <span class="keyword">new</span> SecureRandom();</span><br><span class="line">			<span class="keyword">byte</span>[] salt = random.generateSeed(<span class="number">8</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 口令与密钥</span></span><br><span class="line">			String password = <span class="string">"timliu"</span>;</span><br><span class="line">			PBEKeySpec pbeKeySpec = <span class="keyword">new</span> PBEKeySpec(password.toCharArray()); </span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"PBEWITHMD5andDES"</span>);</span><br><span class="line">			Key key = factory.generateSecret(pbeKeySpec);</span><br><span class="line">			</span><br><span class="line">									</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			PBEParameterSpec pbeParameterSpac = <span class="keyword">new</span> PBEParameterSpec(salt, <span class="number">100</span>);</span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"PBEWITHMD5andDES"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, key, pbeParameterSpac);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk pbe encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, key, pbeParameterSpac);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"jdk pbe decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Java实现非对称加密"><a href="#Java实现非对称加密" class="headerlink" title="Java实现非对称加密"></a>Java实现非对称加密</h2><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/44.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/44.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/45.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/45.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/46.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/46.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/47.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/47.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/48.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/48.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/49.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/49.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/50.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/50.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/51.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/51.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/52.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/52.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/53.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/53.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/54.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/54.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/55.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/55.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/56.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/56.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/57.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/57.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/58.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/58.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/59.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/59.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyAgreement;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.interfaces.DHPublicKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DHParameterSpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.utils.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DHTest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"dh test"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkDH();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// jdk实现：</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkDH</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;		</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 1.初始化发送方密钥</span></span><br><span class="line">			KeyPairGenerator senderKeyPairGenerator = KeyPairGenerator.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			senderKeyPairGenerator.initialize(<span class="number">512</span>);</span><br><span class="line">			KeyPair senderKeyPair = senderKeyPairGenerator.generateKeyPair();</span><br><span class="line">			<span class="comment">// 发送方公钥，发送给接收方（网络、文件。。。）</span></span><br><span class="line">			<span class="keyword">byte</span>[] senderPublicKeyEnc = senderKeyPair.getPublic().getEncoded();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 2.初始化接收方密钥</span></span><br><span class="line">			KeyFactory receiverKeyFactory = KeyFactory.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			X509EncodedKeySpec x509EncodedKeySpec = <span class="keyword">new</span> X509EncodedKeySpec(senderPublicKeyEnc);</span><br><span class="line">			PublicKey receiverPublicKey = receiverKeyFactory.generatePublic(x509EncodedKeySpec);</span><br><span class="line">			DHParameterSpec dhParameterSpec = ((DHPublicKey) receiverPublicKey).getParams();</span><br><span class="line">			KeyPairGenerator receiverKeyPairGenerator = KeyPairGenerator.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			receiverKeyPairGenerator.initialize(dhParameterSpec);</span><br><span class="line">			KeyPair receiverKeypair = receiverKeyPairGenerator.generateKeyPair();</span><br><span class="line">			PrivateKey receiverPrivateKey = receiverKeypair.getPrivate();</span><br><span class="line">			<span class="keyword">byte</span>[] receiverPublicKeyEnc = receiverKeypair.getPublic().getEncoded();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 3.密钥构建</span></span><br><span class="line">			KeyAgreement receiverKeyAgreement = KeyAgreement.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			receiverKeyAgreement.init(receiverPrivateKey);</span><br><span class="line">			receiverKeyAgreement.doPhase(receiverPublicKey, <span class="keyword">true</span>);</span><br><span class="line">			SecretKey receiverDesKey = receiverKeyAgreement.generateSecret(<span class="string">"DES"</span>);</span><br><span class="line">			</span><br><span class="line">			KeyFactory senderKeyFactory = KeyFactory.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			x509EncodedKeySpec = <span class="keyword">new</span> X509EncodedKeySpec(receiverPublicKeyEnc);</span><br><span class="line">			PublicKey senderPublicKey = senderKeyFactory.generatePublic(x509EncodedKeySpec);</span><br><span class="line">			KeyAgreement senderKeyAgreement = KeyAgreement.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			senderKeyAgreement.init(senderKeyPair.getPrivate());</span><br><span class="line">			senderKeyAgreement.doPhase(senderPublicKey, <span class="keyword">true</span>);</span><br><span class="line">			SecretKey senderDesKey = senderKeyAgreement.generateSecret(<span class="string">"DES"</span>);</span><br><span class="line">			<span class="keyword">if</span>(Objects.equals(receiverDesKey, senderDesKey))</span><br><span class="line">			&#123;</span><br><span class="line">				System.out.println(<span class="string">"双方密钥相同。"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 4.加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, senderDesKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc dh encrypt:"</span> + Base64.encodeBase64String(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 5.解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, receiverDesKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"bc dh decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;			</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/60.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/60.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/61.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/61.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/62.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/62.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.RSAPrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.RSAPublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyAgreement;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.interfaces.DHPublicKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DHParameterSpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.utils.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RSATest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"rsa test"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkRSA();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// jdk实现：</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkRSA</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;		</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 1.初始化发送方密钥</span></span><br><span class="line">			KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			keyPairGenerator.initialize(<span class="number">512</span>);</span><br><span class="line">			KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br><span class="line">			RSAPublicKey rsaPublicKey = (RSAPublicKey) keyPair.getPublic();</span><br><span class="line">			RSAPrivateKey rsaPrivateKey = (RSAPrivateKey) keyPair.getPrivate();</span><br><span class="line">			System.out.println(<span class="string">"Public Key:"</span> + Base64.encodeBase64String(rsaPublicKey.getEncoded()));</span><br><span class="line">			System.out.println(<span class="string">"Private Key:"</span> + Base64.encodeBase64String(rsaPrivateKey.getEncoded()));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 2.私钥加密、公钥解密 ---- 加密</span></span><br><span class="line">			PKCS8EncodedKeySpec pkcs8EncodedKeySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(rsaPrivateKey.getEncoded());</span><br><span class="line">			KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			PrivateKey privateKey = keyFactory.generatePrivate(pkcs8EncodedKeySpec);</span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, privateKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"私钥加密、公钥解密 ---- 加密:"</span> + Base64.encodeBase64String(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 3.私钥加密、公钥解密 ---- 解密</span></span><br><span class="line">			X509EncodedKeySpec x509EncodedKeySpec = <span class="keyword">new</span> X509EncodedKeySpec(rsaPublicKey.getEncoded());</span><br><span class="line">			keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			PublicKey publicKey = keyFactory.generatePublic(x509EncodedKeySpec);</span><br><span class="line">			cipher = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, publicKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"私钥加密、公钥解密 ---- 解密:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 4.公钥加密、私钥解密 ---- 加密</span></span><br><span class="line">			X509EncodedKeySpec x509EncodedKeySpec2 = <span class="keyword">new</span> X509EncodedKeySpec(rsaPublicKey.getEncoded());</span><br><span class="line">			KeyFactory keyFactory2 = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			PublicKey publicKey2 = keyFactory2.generatePublic(x509EncodedKeySpec2);</span><br><span class="line">			Cipher cipher2 = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			cipher2.init(Cipher.ENCRYPT_MODE, publicKey2);</span><br><span class="line">			<span class="keyword">byte</span>[] result2 = cipher2.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"公钥加密、私钥解密 ---- 加密:"</span> + Base64.encodeBase64String(result2));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 5.私钥解密、公钥加密 ---- 解密</span></span><br><span class="line">			PKCS8EncodedKeySpec pkcs8EncodedKeySpec5 = <span class="keyword">new</span> PKCS8EncodedKeySpec(rsaPrivateKey.getEncoded());</span><br><span class="line">			KeyFactory keyFactory5 = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			PrivateKey privateKey5 = keyFactory5.generatePrivate(pkcs8EncodedKeySpec5);</span><br><span class="line">			Cipher cipher5 = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			cipher5.init(Cipher.DECRYPT_MODE, privateKey5);</span><br><span class="line">			<span class="keyword">byte</span>[] result5 = cipher5.doFinal(result2);</span><br><span class="line">			System.out.println(<span class="string">"公钥加密、私钥解密 ---- 解密:"</span> + <span class="keyword">new</span> String(result5));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/62.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/62.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/63.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/63.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/64.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/64.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/65.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/65.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/66.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/66.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/67.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/67.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<p>参考：<br><a href="https://github.com/Tim9Liu9/java_security" target="_blank" rel="noopener">https://github.com/Tim9Liu9/java_security</a></p>

                    
                        

                    
                    
                        <p>
                            <a href="/2020/08/19/JAVA实现对称加密/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2020/04/18/加密类型及其相关算法/">
                            加密类型及其相关算法
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-04-18T14:50:24+08:00">
	
		    4月 18, 2020
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="一、数据传输安全性"><a href="#一、数据传输安全性" class="headerlink" title="一、数据传输安全性"></a>一、数据传输安全性</h2><h5 id="在TCP-IP层中不涉及安全"><a href="#在TCP-IP层中不涉及安全" class="headerlink" title="在TCP/IP层中不涉及安全"></a>在TCP/IP层中不涉及安全</h5><ul>
<li>机密性：明文传输（ftp,smtp,talnet）别人一拦截就能看到请求的内容。</li>
<li>完整性：10颗原子弹（被改成100）所以数据在互联网上传播的时候，不应该也不能够被其他人非法篡改掉。当收到的和发送的不一致时拒绝接受这就能保证数据的完整性。</li>
<li>身份验证：通过有效的手段保证所访问的对象就是我们所要的那个人。</li>
</ul>
<h4 id="保证数据的机密性"><a href="#保证数据的机密性" class="headerlink" title="保证数据的机密性"></a>保证数据的机密性</h4><ul>
<li>plaintext(明文) –&gt; 加密（转换规则）–&gt; ciphertext（密文）</li>
<li>ciphertext –&gt; 转换规则 –&gt; plaintext</li>
<li>转换算法：依赖密钥（即使得到了转换规则也没用）</li>
<li>对称加密：加密和解密使用同一个密钥（有加密算法和解密算法，算法不同，但密钥相同）。<br>好处是计算速度快，在一定程度上解决了机密性问题。坏处是不能解决密钥有效管理的问题。<br>假如a跟b，c,d通信，如果密钥相同，则c只要用密钥就可以看到a发送给b的内容，显然密钥不能相同，<br>那就得维护很多密钥。</li>
</ul>
<h4 id="保证数据的完整性"><a href="#保证数据的完整性" class="headerlink" title="保证数据的完整性"></a>保证数据的完整性</h4><ul>
<li>A：plaintext:footprint –&gt; B<br>B使用同样的加密算法去重复计算这个明文的特征码，并跟A所发过来的特征码进行比较，<br>如果一样，则说明没被篡改。</li>
<li>单项加密算法：提取数据特征码，追加到数据后面。数据的输入一样：特征码必然相同。</li>
<li>特点：<br>输入一样，输出必然相同<br>雪崩效应（输入的微小改变，将其会引起结果的巨大改变）<br>定长输出（无论原始数据是多长，结果大小都是相同的）<br>不可逆（无法根据原始特征码还原原来的数据）</li>
</ul>
<h4 id="中间人攻击问题"><a href="#中间人攻击问题" class="headerlink" title="中间人攻击问题"></a>中间人攻击问题</h4><ul>
<li>E(A)：plaintext2:footprint2 –&gt; B<br>A生成一段数据，并对它计算特征码，E在中间经过的路由时拿到这个明文，并重新修改明文和再计算特征码发给B，还声称自己是A，B拿到数据之后就算使用了数据完整性的算法之后，计算特征码还是一模一样，还认为是A发过来的，所以需要借助额外的机制。</li>
<li>解决办法：A：plaintext:footprint(加密) –&gt; B B拿到特征码之后通过密钥进行解密，能解密<br>说明数据没有被改过。如果E拿到plaintext并修改为plaintext2，并重新生成特征码，就没办法加密<br>特征码或者加密后就不是A和B之间实现约定的密码。</li>
</ul>
<h4 id="A与B之间如何进行密码约定"><a href="#A与B之间如何进行密码约定" class="headerlink" title="A与B之间如何进行密码约定"></a>A与B之间如何进行密码约定</h4><ul>
<li>假如A与B之间从未通信或从未见过面，如何进行密码约定呢？</li>
<li>协商生成密码：密码交换（Internet Key Exchange / IKE）,密码交换是不让第三方得到密钥，<br>密码交换需要特殊的互联网协议支撑。比如：Dffie-Hellman协议。</li>
<li>A和B事先约定两个数p(大素数)，g(生成数)。A生成一个自己知道的x，B生成一个自己知道的y。<br>A将 g^x % p 发送给B，B将g^y % p 发送给A。<br>A拿到之后进行计算 （g^y % p）^x = g^xy % p，<br>B拿到之后进行计算 （g^x % p）^y = g^xy % p。<br>这个相同的结果就是密钥。<br>在互联网上可以看到g、p、g^x % p、g^y % p，但看不到x、y。</li>
<li>A和B只需要选好几个数，让这些数的计算结果作为密钥来用，使得彼此不用计算密码，只要双方<br>生成密钥的软件一样就可以随时生成密钥。</li>
</ul>
<h4 id="身份验证"><a href="#身份验证" class="headerlink" title="身份验证"></a>身份验证</h4><ul>
<li>之前是A和B一起约定好的密码，所以身份验证没问题。但是密钥是交换生成的，事先之前谁也不知道。<br>E跳出来，截取了数据并篡改，然后与B进行连接通信，还告诉它自己是A。</li>
<li>解决办法：公钥加密算法（非对称加密算法）</li>
<li>特点：拥有一对密钥对，分别是公钥（是从私钥中提取出来的）、私钥。用公钥加密的，只能用私钥<br>解密，反之亦然。</li>
</ul>
<h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><ul>
<li>机密性：用B的公钥加密，B的私钥解密。发送方用对方的公钥加密数据，可以保证数据机密性。</li>
<li>身份验证：用A的私钥加密，A的公钥解密。发送方用自己的私钥加密数据，可以实现身份验证。</li>
<li>公钥加密算法很少用来加密数据：速度太慢。非对称加密的主要作用也就是身份验证。</li>
</ul>
<h2 id="二、数据传输"><a href="#二、数据传输" class="headerlink" title="二、数据传输"></a>二、数据传输</h2><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/数据传输.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/数据传输.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<p>PKI:公钥基础设施(Public Key Infrastructure) 核心就是CA和彼此之间的信任关系<br>CA:证书颁发机构(Certificate Authority)，CA中还维护了CRL<br>CRL:证书撤销列表，CRL中保存了此前曾经发出去的证书，但仍未过期，只不过已经各种原因被撤销了</p>
<h2 id="三、TLS-SSL"><a href="#三、TLS-SSL" class="headerlink" title="三、TLS/SSL"></a>三、TLS/SSL</h2><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/1.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/1.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<h3 id="不同标准下的证书格式是不同的"><a href="#不同标准下的证书格式是不同的" class="headerlink" title="不同标准下的证书格式是不同的"></a>不同标准下的证书格式是不同的</h3><p>比如x509, pkcs12<br>x509: 公钥及其有效期限，证书的合法拥有者，证书该如何被使用，CA的信息，CA签名的校验码<br>TLS/SSL所使用的正是x509的证书，TLS/SSL其实就是一种PKI，PKI的第二种实现OpenGPG</p>
<h3 id="TLS-SSL-如何实现握手认证、密钥交换"><a href="#TLS-SSL-如何实现握手认证、密钥交换" class="headerlink" title="TLS/SSL 如何实现握手认证、密钥交换"></a>TLS/SSL 如何实现握手认证、密钥交换</h3><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/2.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/2.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<h2 id="四、加密"><a href="#四、加密" class="headerlink" title="四、加密"></a>四、加密</h2><h3 id="对称加密"><a href="#对称加密" class="headerlink" title="对称加密"></a>对称加密</h3><p>加密解密使用同一个密码</p>
<ul>
<li>DES(Data Encrption Standard, 56bit)</li>
<li>3DES</li>
<li>AES(Advanced, AES192/AES256/AES512)</li>
<li>Blowfish</li>
</ul>
<h3 id="单向加密"><a href="#单向加密" class="headerlink" title="单向加密"></a>单向加密</h3><ul>
<li>MD4</li>
<li>MD5</li>
<li>SHA1</li>
<li>SHA192、SHA256、SHA384</li>
<li>CRC-32</li>
</ul>
<h3 id="非对称加密（公钥加密）"><a href="#非对称加密（公钥加密）" class="headerlink" title="非对称加密（公钥加密）"></a>非对称加密（公钥加密）</h3><p>身份认证（数字签名）、数据加密、密钥交换</p>
<ul>
<li>RSA(加密、签名)</li>
<li>DSA(签名)</li>
<li>ElGamal</li>
</ul>
<h3 id="加密实现"><a href="#加密实现" class="headerlink" title="加密实现"></a>加密实现</h3><p>OpenSSL: SSL的开源实现<br>  libcryptc: 通用的加密库<br>  libssl: TLS/SSL的实现<br>    基于会话的、实现了省份认证、数据机密性和会话完整性的TLS/SSL库<br>  openssl: 多用途命令行工具<br>    实现私有证书颁发机构</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2020/04/18/加密类型及其相关算法/#post-footer" class="postShorten-excerpt_link link">
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">第 1 页 共 1 页</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 Brotherc. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/head.jpg" alt="作者的图片">
        
            <h4 id="about-card-name">Brotherc</h4>
        
            <div id="about-card-bio"><p>java development</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>java</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br>
                zhuhai
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-dbd16rvloemmuxdzniplmnxxvwoz24eya9wol0b7vvmlokgqsjivmb8dnscy.min.js"></script>
<!--SCRIPTS END-->



    </body>
</html>
