(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{2354:function(s,a,t){"use strict";t.r(a);var e=t(2),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"docker导学"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker导学"}},[s._v("#")]),s._v(" Docker导学")]),s._v(" "),a("p",[a("strong",[s._v("到底什么是Docker?")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(430),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Docker能干什么?")])]),s._v(" "),a("ul",[a("li",[s._v("简化配置")]),s._v(" "),a("li",[s._v("整合服务器")]),s._v(" "),a("li",[s._v("代码流水线管理")]),s._v(" "),a("li",[s._v("调试能力")]),s._v(" "),a("li",[s._v("提高开发效率")]),s._v(" "),a("li",[s._v("多租户")]),s._v(" "),a("li",[s._v("隔离应用")]),s._v(" "),a("li",[s._v("快速部署")])]),s._v(" "),a("p",[a("strong",[s._v('容器时代的"双城记"')])]),s._v(" "),a("ul",[a("li",[s._v("Docker")]),s._v(" "),a("li",[s._v("Kubernetes")])]),s._v(" "),a("p",[a("strong",[s._v("大海航行靠舵手-Kubernetes")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(431),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("DevOps = 文化 + 过程 + 工具")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(432),alt:""}}),s._v(" "),a("img",{attrs:{src:t(433),alt:""}})]),s._v(" "),a("h2",{attrs:{id:"容器技术概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器技术概述"}},[s._v("#")]),s._v(" 容器技术概述")]),s._v(" "),a("p",[a("strong",[s._v("Long Long Time Ago")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(434),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("虚拟化技术出现以后")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(435),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("虚拟化的优点")])]),s._v(" "),a("ul",[a("li",[s._v("资源池-一个物理机的资源分配到了不同的虚拟机里")]),s._v(" "),a("li",[s._v("很容易扩展-加物理机or加虚拟机")]),s._v(" "),a("li",[s._v("很容易云化-亚马逊AWS，阿里云等")])]),s._v(" "),a("p",[a("strong",[s._v("虚拟化的局限性")])]),s._v(" "),a("ul",[a("li",[s._v("每一个虚拟机都是一个完整的操作系统，要给其分配资源，当虚拟机数量增多时，操作系统本身消耗的资源势必增多")])]),s._v(" "),a("p",[a("strong",[s._v("开发和运维面临的挑战")]),a("img",{attrs:{src:t(436),alt:""}}),s._v(" "),a("strong",[s._v("容器解决了什么问题?")]),a("img",{attrs:{src:t(437),alt:""}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("解决了开发和运维之间的矛盾")])]),s._v(" "),a("li",[a("p",[s._v("在开发和运维之间搭建了一个桥梁，是实现devops的最佳解决方案")])])]),s._v(" "),a("p",[a("strong",[s._v("什么是容器？")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(438),alt:""}}),s._v(" "),a("strong",[s._v("容器和虚拟机的区别")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(439),alt:""}}),s._v(" "),a("strong",[s._v("虚拟机 + 容器")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(440),alt:""}}),s._v(" "),a("strong",[s._v("Docker - 容器技术的一种实现")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(441),alt:""}})]),s._v(" "),a("h2",{attrs:{id:"docker架构和底层技术简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker架构和底层技术简介"}},[s._v("#")]),s._v(" Docker架构和底层技术简介")]),s._v(" "),a("p",[a("strong",[s._v("Docker Platform")])]),s._v(" "),a("ul",[a("li",[s._v("Docker提供了一个开发，打包，运行app的平台")]),s._v(" "),a("li",[s._v("把app和底层infrastructure隔离开来")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(442),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Docker Engine")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(443),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Docker Architecture")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(444),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("底层技术")])]),s._v(" "),a("ul",[a("li",[s._v("Namespaces：做隔离pid，net，ipc，mnt，uts")]),s._v(" "),a("li",[s._v("Control groups：做资源限制")]),s._v(" "),a("li",[s._v("Union file systems：Container和image的分层")])]),s._v(" "),a("h2",{attrs:{id:"在centos上安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在centos上安装docker"}},[s._v("#")]),s._v(" 在centos上安装docker")]),s._v(" "),a("p",[a("strong",[s._v("安装")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-common "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-selinux "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-engine\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" yum-utils "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndevice-mapper-persistent-data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nlvm2\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--add-repo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nhttps://download.docker.com/linux/centos/docker-ce.repo\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[a("strong",[s._v("启动")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("helloworld")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"docker-image概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-image概述"}},[s._v("#")]),s._v(" Docker Image概述")]),s._v(" "),a("p",[a("strong",[s._v("什么是Image")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(445),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Image的获取(1)")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(446),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Image的获取(2)")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(447),alt:""}})]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("// 查看进程\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ef")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n// 查看镜像\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n// 拉取镜像\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull ubuntu:14.04\n// 运行镜像\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" centos\n// 删除镜像\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 67759a80360c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("镜像ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image rmi f2a91732366c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("镜像ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h2",{attrs:{id:"diy一个base-image"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#diy一个base-image"}},[s._v("#")]),s._v(" DIY一个Base Image")]),s._v(" "),a("p",[a("strong",[s._v("自己实现helloworld")])]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("mkdir hello"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("world\ncd hello"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("world"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\nvim hello"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 内容")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello docker\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ngcc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" hello"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o hello\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[s._v("vim Dockerfile\n\n// 内容\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" scratch")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" hello /")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/hello"')]),s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" brotherc/hello-world "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run brotherc/hello-world\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"初始container"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始container"}},[s._v("#")]),s._v(" 初始container")]),s._v(" "),a("p",[a("strong",[s._v("什么是Container")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(448),alt:""}})]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"status-exited"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aq")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 846b5efe98d4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("容器ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("容器ID前缀"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n// 将已有容器提交成新的镜像\nUsage: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" CONTAINER "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("REPOSITORY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":TAG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit xenodochial_pare"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("容器名称"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" brotherc/centos-vim\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop 容器id或名称\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start 容器id或名称\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect 容器id或名称\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs 容器id或名称\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"构建自己的docker镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建自己的docker镜像"}},[s._v("#")]),s._v(" 构建自己的Docker镜像")]),s._v(" "),a("p",[a("strong",[s._v("基于已经存在的container创建一个image")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("// 运行一个已安装好vim的centos容器\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" centos\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("// 容器名：xenodochial_pare\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit xenodochial_pare brotherc/centos-vim\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("基于Dockerfile创建一个image")])]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[s._v("mkdir docker-centos-vim\ncd docker-centos-vim/\nvim Dockerfile\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install -y vim")]),s._v("\n\ndocker build -t brotherc/centos-vim-new .\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"dockerfile语法梳理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile语法梳理"}},[s._v("#")]),s._v(" Dockerfile语法梳理")]),s._v(" "),a("p",[a("strong",[s._v("FROM")]),s._v("\n尽量使用官方的image作为base image!")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" scratch #制作base image")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos  #使用base image")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" ubuntu:14.04")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("LABEL")]),s._v("\nMetadata不可少!")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" maintainer="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"brotherc@136.com"')])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" version="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0"')])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" description="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"This is description"')])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("RUN")]),s._v("\n为了美观，复杂的RUN请用反斜杠换行!避免无用分层，合并多条命令成一行!")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum update && yum install -y vim \\ #反斜线换行")]),s._v("\n    python-dev\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apt-get update && apt-get install -y perl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    pwgen --no-install-recommends && rm -rf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    /var/lib/apt/lists/* #注意清理cache")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" /bin/bash -c"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'source $HOME/.bashrc;echo $HOME'")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("WORKDIR")]),s._v("\n设定当前工作目录，类似cd\n用WORKDIR，不要用RUN cd!尽量使用绝对目录!")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /root")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /test #如果没有会自动创建test目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" demo")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" pwd       #输出结果应该是 /test/demo")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("ADD and COPY")]),s._v("\n将本地文件添加到image里面\n大部分情况，COPY优于ADD!ADD除了COPY还有额外功能(解压)!添加远程文件/目录\n请使用curl或者wget!")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" hello /")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" test.tar.gz / #添加到根目录并解压")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" hello test/ # /root/test/hello")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" hello test/")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("ENV")]),s._v("\n尽量使用ENV增加可维护性!")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" MYSQL_VERSION 5.6 #设置常量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apt-get install -y mysql-server="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${MYSQL_VERSION}"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    && rm -rf /var/lib/apt/lists/* #引用常量")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("RUN vs CMD vs ENTRYPOINT")]),s._v("\nRUN:执行命令并创建新的image layer\nCMD:设置容器启动后默认执行的命令和参数\nENTRYPOINT:设置容器启动时运行的命令\n"),a("strong",[s._v("Shell格式")])]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apt-get install -y vim")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello docker"')])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello docker"')])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" name Docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello $name"')])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("Exec格式")])]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"apt-get"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"install"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-y"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vim"')]),s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/echo"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello docker"')]),s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/echo"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello docker"')]),s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" name Docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/echo"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello docker"')]),s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"dockerfile最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile最佳实践"}},[s._v("#")]),s._v(" Dockerfile最佳实践")]),s._v(" "),a("p",[s._v("Dockerfile:")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" name Docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello $name"')])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[s._v("docker build -t brotherc/centos-entrypoint-shell .\ndocker run brotherc/centos-entrypoint-shell\nhello Docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("Dockerfile:")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" name Docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo hello $name"')]),s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[s._v("docker build -t brotherc/centos-entrypoint-exec .\ndocker run brotherc/centos-entrypoint-exec\nhello Docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("CMD")]),s._v("\n容器启动时默认执行的命令\n如果docker run指定了其它命令，CMD命令被忽略\n如果定义了多个CMD，只有最后一个会执行\nDockerfile:")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" name Docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello $name"')])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" brotherc/centos-cmd-shell "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run brotherc/centos-cmd-shell\nhello Docker\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" brotherc/centos-cmd-shell /bin/bash\n无输出\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("strong",[s._v("ENTRYPOINT")]),s._v("\n让容器以应用程序或者服务的形式运行\n不会被忽略，一定会执行")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run brotherc/centos-entrypoint-shell\nhello Docker\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" brotherc/centos-entrypoint-shell /bin/bash\nhello Docker\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"镜像的发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像的发布"}},[s._v("#")]),s._v(" 镜像的发布")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push DockerId/镜像名称\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull DockerId/镜像名称\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("分享产生image")]),s._v("\n把我们的账户link到github或bitbucket，在github上面创建一个代码仓库，把我们的dockerfile push上去，这样就做了一个关联。\n只要我们这个仓库里面有dockerfile，就会自动去克隆获取到这个dockerfile然后dockerhub后台服务器会帮我们去build。\n这样我们既提供了dockerfile，docker image又是dockerhub后台服务器帮我们build的，这个安全性会有很大的提升。\n"),a("img",{attrs:{src:t(449),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("私有的registry")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(":5000 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),s._v(" always "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" registry\n// 访问ip:5000\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("/etc/docker/daemon.json:")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"insecure-registries"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ip:5000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("/lib/systemd/system/docker.service:\n"),a("img",{attrs:{src:t(450),alt:""}})]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("telnet ip:5000\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push ip:5000/镜像名称\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull ip:5000/镜像名称\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"docker-network"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-network"}},[s._v("#")]),s._v(" Docker Network")]),s._v(" "),a("p",[a("strong",[s._v("基础网络概念")]),s._v(" "),a("img",{attrs:{src:t(451),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("基于数据包的通信方式")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(452),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("网络的分层")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(453),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("路由的概念")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(454),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("IP地址和路由")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(455),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("公有IP和私有IP")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Public IP：互联网的唯一标识，可以访问internet")])]),s._v(" "),a("li",[a("p",[s._v("Private IP：不可在互联网上使用，仅供机构内部使用")]),s._v(" "),a("p",[s._v("A类 10.0.0.0--10.255.255.255 （10.0.0.0/8）")]),s._v(" "),a("p",[s._v("B类 172.16.0.0--172.31.255.255 （172.16.0.0/12）")]),s._v(" "),a("p",[s._v("C类 192.168.0.0--192.168.255.255 （192.168.0.0/16）")])])]),s._v(" "),a("p",[a("strong",[s._v("网络地址转换NAT")]),s._v(" "),a("img",{attrs:{src:t(456),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Ping和telnet")])]),s._v(" "),a("ul",[a("li",[s._v("Ping(ICMP)：验证IP的可达性")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(457),alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("telnet：验证服务的可用性")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(458),alt:""}})]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" test1 busybox /bin/sh "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true; do sleep 3600; done"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" test1 /bin/sh\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" a\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" test2 busybox /bin/sh "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true; do sleep 3600; done"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" test2 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" a\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:t(459),alt:""}}),s._v(" "),a("img",{attrs:{src:t(460),alt:""}}),s._v(" "),a("img",{attrs:{src:t(461),alt:""}}),s._v(" "),a("img",{attrs:{src:t(462),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Linux Network Namespace")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(463),alt:""}}),s._v(" "),a("img",{attrs:{src:t(464),alt:""}}),s._v(" "),a("img",{attrs:{src:t(465),alt:""}}),s._v(" "),a("img",{attrs:{src:t(466),alt:""}}),s._v(" "),a("img",{attrs:{src:t(467),alt:""}}),s._v(" "),a("img",{attrs:{src:t(468),alt:""}}),s._v(" "),a("img",{attrs:{src:t(469),alt:""}}),s._v(" "),a("img",{attrs:{src:t(470),alt:""}}),s._v(" "),a("img",{attrs:{src:t(471),alt:""}}),s._v(" "),a("img",{attrs:{src:t(472),alt:""}}),s._v(" "),a("img",{attrs:{src:t(473),alt:""}}),s._v(" "),a("img",{attrs:{src:t(474),alt:""}}),s._v(" "),a("img",{attrs:{src:t(475),alt:""}}),s._v(" "),a("img",{attrs:{src:t(476),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Bridge Network")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(477),alt:""}}),s._v(" "),a("img",{attrs:{src:t(478),alt:""}}),s._v(" "),a("img",{attrs:{src:t(479),alt:""}}),s._v(" "),a("img",{attrs:{src:t(480),alt:""}}),s._v(" "),a("img",{attrs:{src:t(481),alt:""}}),s._v(" "),a("img",{attrs:{src:t(482),alt:""}}),s._v(" "),a("img",{attrs:{src:t(483),alt:""}}),s._v(" "),a("img",{attrs:{src:t(484),alt:""}}),s._v(" "),a("img",{attrs:{src:t(485),alt:""}}),s._v(" "),a("img",{attrs:{src:t(486),alt:""}}),s._v(" "),a("img",{attrs:{src:t(487),alt:""}}),s._v(" "),a("img",{attrs:{src:t(488),alt:""}}),s._v(" "),a("img",{attrs:{src:t(489),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Container Port Map")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(490),alt:""}}),s._v(" "),a("img",{attrs:{src:t(491),alt:""}}),s._v(" "),a("img",{attrs:{src:t(492),alt:""}}),s._v(" "),a("img",{attrs:{src:t(493),alt:""}}),s._v(" "),a("img",{attrs:{src:t(494),alt:""}}),s._v(" "),a("img",{attrs:{src:t(495),alt:""}})]),s._v(" "),a("h2",{attrs:{id:"docker的持久化存储和数据共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker的持久化存储和数据共享"}},[s._v("#")]),s._v(" Docker的持久化存储和数据共享")]),s._v(" "),a("p",[a("strong",[s._v("Container Layer")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(496),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Data Volume")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(497),alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("Docker持久化数据的方案")])]),s._v(" "),a("ul",[a("li",[s._v("基于本地文件系统的Volume。可以在执行Docker create或Docker run时，通过-v参数将主机的目录作为容器的数据卷。这部分功能便是基于本地文件系统的volume管理。")]),s._v(" "),a("li",[s._v("基于plugin的Volume，支持第三方的存储方案，比如NAS，aws")])]),s._v(" "),a("p",[a("strong",[s._v("Volume的类型")])]),s._v(" "),a("ul",[a("li",[s._v("受管理的data Volume，由docker后台自动创建。")]),s._v(" "),a("li",[s._v("绑定挂载的Volume，具体挂载位置可以由用户指定。")])]),s._v(" "),a("p",[a("strong",[s._v("数据持久化：Data Volume")]),s._v(" "),a("img",{attrs:{src:t(498),alt:""}})]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("//mysql镜像会默认将数据挂载到本地\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ALLOW_EMPTY_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\nDRIVER        VOLUME NAME\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("         e6ee5901156"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume inspect e6ee5901156"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop mysql1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" mysql1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\nDRIVER        VOLUME NAME\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("         e6ee5901156"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("//给volume指定名字\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" mysql:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ALLOW_EMPTY_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true mysql\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\nDRIVER        VOLUME NAME\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("         mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("//让mysql容器使用已存在的volume\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" mysql1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" mysql:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ALLOW_EMPTY_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("数据持久化：Bind Mouting")]),s._v(" "),a("img",{attrs:{src:t(499),alt:""}}),s._v("\nDockerfile:")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx:latest")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /usr/share/nginx/html")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" index.html index.html")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" brotherc/my-nginx "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" web brotherc/my-nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" web\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(":/usr/share/nginx/html "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" web brotherc/my-nginx\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" web /bin/bash\n//在容器中\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/share/nginx/html\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" test.txt\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n//在linux中看到刚刚创建的test.txt文件\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports},430:function(s,a,t){s.exports=t.p+"assets/img/1.49248b87.jpg"},431:function(s,a,t){s.exports=t.p+"assets/img/4.b7d10d50.jpg"},432:function(s,a,t){s.exports=t.p+"assets/img/5.40df902f.jpg"},433:function(s,a,t){s.exports=t.p+"assets/img/6.02aa8d7e.jpg"},434:function(s,a,t){s.exports=t.p+"assets/img/7.43cb20b4.jpg"},435:function(s,a,t){s.exports=t.p+"assets/img/8.580f87a6.jpg"},436:function(s,a,t){s.exports=t.p+"assets/img/11.96aedaf9.jpg"},437:function(s,a,t){s.exports=t.p+"assets/img/12.87899cc2.jpg"},438:function(s,a,t){s.exports=t.p+"assets/img/14.3dac5a5d.jpg"},439:function(s,a,t){s.exports=t.p+"assets/img/15.78544a0f.jpg"},440:function(s,a,t){s.exports=t.p+"assets/img/16.fcdfd79f.jpg"},441:function(s,a,t){s.exports=t.p+"assets/img/17.0b9d15b6.jpg"},442:function(s,a,t){s.exports=t.p+"assets/img/18.3e457d47.jpg"},443:function(s,a,t){s.exports=t.p+"assets/img/19.5f48da30.jpg"},444:function(s,a,t){s.exports=t.p+"assets/img/20.607d802e.jpg"},445:function(s,a,t){s.exports=t.p+"assets/img/22.674a2953.jpg"},446:function(s,a,t){s.exports=t.p+"assets/img/23.022c1758.jpg"},447:function(s,a,t){s.exports=t.p+"assets/img/24.434ed35d.jpg"},448:function(s,a,t){s.exports=t.p+"assets/img/25.6862375c.jpg"},449:function(s,a,t){s.exports=t.p+"assets/img/78.80379abd.jpg"},450:function(s,a,t){s.exports=t.p+"assets/img/79.9d702e81.jpg"},451:function(s,a,t){s.exports=t.p+"assets/img/32.aea8f3e7.jpg"},452:function(s,a,t){s.exports=t.p+"assets/img/33.ad01b7ab.jpg"},453:function(s,a,t){s.exports=t.p+"assets/img/34.bf369dce.jpg"},454:function(s,a,t){s.exports=t.p+"assets/img/35.218fb849.jpg"},455:function(s,a,t){s.exports=t.p+"assets/img/36.eb373204.jpg"},456:function(s,a,t){s.exports=t.p+"assets/img/38.070a8e40.jpg"},457:function(s,a,t){s.exports=t.p+"assets/img/39.8acdd84c.jpg"},458:function(s,a,t){s.exports=t.p+"assets/img/40.fedbcec2.jpg"},459:function(s,a,t){s.exports=t.p+"assets/img/41.0b01a599.jpg"},460:function(s,a,t){s.exports=t.p+"assets/img/42.8ffed81a.jpg"},461:function(s,a,t){s.exports=t.p+"assets/img/43.1713a1d3.jpg"},462:function(s,a,t){s.exports=t.p+"assets/img/44.01fe79b8.jpg"},463:function(s,a,t){s.exports=t.p+"assets/img/45.77968b22.jpg"},464:function(s,a,t){s.exports=t.p+"assets/img/46.c1b924d0.jpg"},465:function(s,a,t){s.exports=t.p+"assets/img/47.2ac716a4.jpg"},466:function(s,a,t){s.exports=t.p+"assets/img/48.c6dc8ab8.jpg"},467:function(s,a,t){s.exports=t.p+"assets/img/49.93ac9a92.jpg"},468:function(s,a,t){s.exports=t.p+"assets/img/50.69b6c35d.jpg"},469:function(s,a,t){s.exports=t.p+"assets/img/51.d5a9fbf5.jpg"},470:function(s,a,t){s.exports=t.p+"assets/img/52.ed75e136.jpg"},471:function(s,a,t){s.exports=t.p+"assets/img/53.b8f4d690.jpg"},472:function(s,a,t){s.exports=t.p+"assets/img/54.10e2a2cf.jpg"},473:function(s,a,t){s.exports=t.p+"assets/img/55.794acda7.jpg"},474:function(s,a,t){s.exports=t.p+"assets/img/56.59a1de31.jpg"},475:function(s,a,t){s.exports=t.p+"assets/img/57.e57449ee.jpg"},476:function(s,a,t){s.exports=t.p+"assets/img/58.071534c8.jpg"},477:function(s,a,t){s.exports=t.p+"assets/img/59.1572f9de.jpg"},478:function(s,a,t){s.exports=t.p+"assets/img/60.824fd8f1.jpg"},479:function(s,a,t){s.exports=t.p+"assets/img/61.589fef84.jpg"},480:function(s,a,t){s.exports=t.p+"assets/img/62.f81e347c.jpg"},481:function(s,a,t){s.exports=t.p+"assets/img/63.db6f0e7d.jpg"},482:function(s,a,t){s.exports=t.p+"assets/img/64.0300c81b.jpg"},483:function(s,a,t){s.exports=t.p+"assets/img/65.55d57a2e.jpg"},484:function(s,a,t){s.exports=t.p+"assets/img/66.29be75b9.jpg"},485:function(s,a,t){s.exports=t.p+"assets/img/67.5e0250af.jpg"},486:function(s,a,t){s.exports=t.p+"assets/img/68.6cbe58b9.jpg"},487:function(s,a,t){s.exports=t.p+"assets/img/69.d4c316ee.jpg"},488:function(s,a,t){s.exports=t.p+"assets/img/70.e67a56d8.jpg"},489:function(s,a,t){s.exports=t.p+"assets/img/71.bc756c5a.jpg"},490:function(s,a,t){s.exports=t.p+"assets/img/72.df98a338.jpg"},491:function(s,a,t){s.exports=t.p+"assets/img/73.405f6c64.jpg"},492:function(s,a,t){s.exports=t.p+"assets/img/74.46679b0c.jpg"},493:function(s,a,t){s.exports=t.p+"assets/img/75.921a8ed7.jpg"},494:function(s,a,t){s.exports=t.p+"assets/img/76.285e9953.jpg"},495:function(s,a,t){s.exports=t.p+"assets/img/77.f923ab69.jpg"},496:function(s,a,t){s.exports=t.p+"assets/img/26.dbff468a.jpg"},497:function(s,a,t){s.exports=t.p+"assets/img/27.e88c1b13.jpg"},498:function(s,a,t){s.exports=t.p+"assets/img/30.e984a828.jpg"},499:function(s,a,t){s.exports=t.p+"assets/img/31.fcde40b7.jpg"}}]);