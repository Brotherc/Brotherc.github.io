<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>docker-基础 | brotherc</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="icon" href="/vue-blog/logo.png">
    <meta name="description" content="博客">
    <link rel="preload" href="/vue-blog/assets/css/0.styles.3df1e362.css" as="style"><link rel="preload" href="/vue-blog/assets/js/app.0b1b22d7.js" as="script"><link rel="preload" href="/vue-blog/assets/js/10.7f2a231e.js" as="script"><link rel="preload" href="/vue-blog/assets/js/5.4de21982.js" as="script"><link rel="prefetch" href="/vue-blog/assets/js/100.d5543f9b.js"><link rel="prefetch" href="/vue-blog/assets/js/101.994e0751.js"><link rel="prefetch" href="/vue-blog/assets/js/102.597d3e82.js"><link rel="prefetch" href="/vue-blog/assets/js/103.a49dad58.js"><link rel="prefetch" href="/vue-blog/assets/js/104.87635474.js"><link rel="prefetch" href="/vue-blog/assets/js/105.893d47e3.js"><link rel="prefetch" href="/vue-blog/assets/js/106.4015e79a.js"><link rel="prefetch" href="/vue-blog/assets/js/107.4e97e1ff.js"><link rel="prefetch" href="/vue-blog/assets/js/108.aeef75bf.js"><link rel="prefetch" href="/vue-blog/assets/js/11.593d643c.js"><link rel="prefetch" href="/vue-blog/assets/js/12.0e29205a.js"><link rel="prefetch" href="/vue-blog/assets/js/13.bb1e0dfc.js"><link rel="prefetch" href="/vue-blog/assets/js/14.da2c6174.js"><link rel="prefetch" href="/vue-blog/assets/js/15.00b0a077.js"><link rel="prefetch" href="/vue-blog/assets/js/16.0d67591c.js"><link rel="prefetch" href="/vue-blog/assets/js/17.a7be4df9.js"><link rel="prefetch" href="/vue-blog/assets/js/18.ebc87c23.js"><link rel="prefetch" href="/vue-blog/assets/js/19.f587e865.js"><link rel="prefetch" href="/vue-blog/assets/js/2.3c75bf04.js"><link rel="prefetch" href="/vue-blog/assets/js/20.5c517c23.js"><link rel="prefetch" href="/vue-blog/assets/js/21.44356056.js"><link rel="prefetch" href="/vue-blog/assets/js/22.1ae670f2.js"><link rel="prefetch" href="/vue-blog/assets/js/23.aac2b95a.js"><link rel="prefetch" href="/vue-blog/assets/js/24.d88b700b.js"><link rel="prefetch" href="/vue-blog/assets/js/25.b06ece24.js"><link rel="prefetch" href="/vue-blog/assets/js/26.3ac21001.js"><link rel="prefetch" href="/vue-blog/assets/js/27.b340b624.js"><link rel="prefetch" href="/vue-blog/assets/js/28.0879f60f.js"><link rel="prefetch" href="/vue-blog/assets/js/29.072b766e.js"><link rel="prefetch" href="/vue-blog/assets/js/3.66fbacab.js"><link rel="prefetch" href="/vue-blog/assets/js/30.63c10a53.js"><link rel="prefetch" href="/vue-blog/assets/js/31.f04524cf.js"><link rel="prefetch" href="/vue-blog/assets/js/32.4a6ec2af.js"><link rel="prefetch" href="/vue-blog/assets/js/33.58f372b0.js"><link rel="prefetch" href="/vue-blog/assets/js/34.72fea823.js"><link rel="prefetch" href="/vue-blog/assets/js/35.b4828dfc.js"><link rel="prefetch" href="/vue-blog/assets/js/36.a056d48d.js"><link rel="prefetch" href="/vue-blog/assets/js/37.c5720216.js"><link rel="prefetch" href="/vue-blog/assets/js/38.d261cf06.js"><link rel="prefetch" href="/vue-blog/assets/js/39.b2dade88.js"><link rel="prefetch" href="/vue-blog/assets/js/4.c444e7fb.js"><link rel="prefetch" href="/vue-blog/assets/js/40.104ca91c.js"><link rel="prefetch" href="/vue-blog/assets/js/41.efd8d365.js"><link rel="prefetch" href="/vue-blog/assets/js/42.4e63facd.js"><link rel="prefetch" href="/vue-blog/assets/js/43.e9af633e.js"><link rel="prefetch" href="/vue-blog/assets/js/44.b085bb08.js"><link rel="prefetch" href="/vue-blog/assets/js/45.f7e093b9.js"><link rel="prefetch" href="/vue-blog/assets/js/46.d9bb03c9.js"><link rel="prefetch" href="/vue-blog/assets/js/47.24aff0c1.js"><link rel="prefetch" href="/vue-blog/assets/js/48.83656bcf.js"><link rel="prefetch" href="/vue-blog/assets/js/49.4450a312.js"><link rel="prefetch" href="/vue-blog/assets/js/50.2a4f2a4c.js"><link rel="prefetch" href="/vue-blog/assets/js/51.f78d95e2.js"><link rel="prefetch" href="/vue-blog/assets/js/52.630481f9.js"><link rel="prefetch" href="/vue-blog/assets/js/53.14acae05.js"><link rel="prefetch" href="/vue-blog/assets/js/54.df6dc3a4.js"><link rel="prefetch" href="/vue-blog/assets/js/55.28829124.js"><link rel="prefetch" href="/vue-blog/assets/js/56.a5060cf5.js"><link rel="prefetch" href="/vue-blog/assets/js/57.0ad26207.js"><link rel="prefetch" href="/vue-blog/assets/js/58.502a2ad8.js"><link rel="prefetch" href="/vue-blog/assets/js/59.0d75bb58.js"><link rel="prefetch" href="/vue-blog/assets/js/6.eb220413.js"><link rel="prefetch" href="/vue-blog/assets/js/60.a8f03abe.js"><link rel="prefetch" href="/vue-blog/assets/js/61.5f8222de.js"><link rel="prefetch" href="/vue-blog/assets/js/62.a9859dbb.js"><link rel="prefetch" href="/vue-blog/assets/js/63.fa92e48f.js"><link rel="prefetch" href="/vue-blog/assets/js/64.c3571900.js"><link rel="prefetch" href="/vue-blog/assets/js/65.45aa7a03.js"><link rel="prefetch" href="/vue-blog/assets/js/66.f3093325.js"><link rel="prefetch" href="/vue-blog/assets/js/67.d2e55292.js"><link rel="prefetch" href="/vue-blog/assets/js/68.981cbdbc.js"><link rel="prefetch" href="/vue-blog/assets/js/69.690bde98.js"><link rel="prefetch" href="/vue-blog/assets/js/7.4f234de2.js"><link rel="prefetch" href="/vue-blog/assets/js/70.9718266c.js"><link rel="prefetch" href="/vue-blog/assets/js/71.492d1746.js"><link rel="prefetch" href="/vue-blog/assets/js/72.c766dd38.js"><link rel="prefetch" href="/vue-blog/assets/js/73.180402a0.js"><link rel="prefetch" href="/vue-blog/assets/js/74.29394b3e.js"><link rel="prefetch" href="/vue-blog/assets/js/75.80dced09.js"><link rel="prefetch" href="/vue-blog/assets/js/76.9a8230ba.js"><link rel="prefetch" href="/vue-blog/assets/js/77.1240e35a.js"><link rel="prefetch" href="/vue-blog/assets/js/78.3a00ecbc.js"><link rel="prefetch" href="/vue-blog/assets/js/79.2e5e2918.js"><link rel="prefetch" href="/vue-blog/assets/js/8.e7b7e393.js"><link rel="prefetch" href="/vue-blog/assets/js/80.2d846fe7.js"><link rel="prefetch" href="/vue-blog/assets/js/81.3d6099c8.js"><link rel="prefetch" href="/vue-blog/assets/js/82.13791230.js"><link rel="prefetch" href="/vue-blog/assets/js/83.c8e155d6.js"><link rel="prefetch" href="/vue-blog/assets/js/84.d0d29068.js"><link rel="prefetch" href="/vue-blog/assets/js/85.33b8e025.js"><link rel="prefetch" href="/vue-blog/assets/js/86.2d18cc93.js"><link rel="prefetch" href="/vue-blog/assets/js/87.32952b94.js"><link rel="prefetch" href="/vue-blog/assets/js/88.70e1567b.js"><link rel="prefetch" href="/vue-blog/assets/js/89.b7834bd7.js"><link rel="prefetch" href="/vue-blog/assets/js/9.d43a5a03.js"><link rel="prefetch" href="/vue-blog/assets/js/90.224a5cbd.js"><link rel="prefetch" href="/vue-blog/assets/js/91.5cbfee95.js"><link rel="prefetch" href="/vue-blog/assets/js/92.a4e84b89.js"><link rel="prefetch" href="/vue-blog/assets/js/93.54f96a0d.js"><link rel="prefetch" href="/vue-blog/assets/js/94.836a465c.js"><link rel="prefetch" href="/vue-blog/assets/js/95.0ff4274e.js"><link rel="prefetch" href="/vue-blog/assets/js/96.f9c12e86.js"><link rel="prefetch" href="/vue-blog/assets/js/97.e26b639c.js"><link rel="prefetch" href="/vue-blog/assets/js/98.d37be4c0.js"><link rel="prefetch" href="/vue-blog/assets/js/99.180bcdae.js">
    <link rel="stylesheet" href="/vue-blog/assets/css/0.styles.3df1e362.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container reform"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vue-blog/" class="home-link router-link-active"><!----> <span class="site-name">brotherc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vue-blog/blog/" class="nav-link router-link-active"><!---->
博客</a></div><div class="nav-item"><a href="/vue-blog/tags/" class="nav-link"><!---->
标签云</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue-blog/blog/" class="nav-link router-link-active"><!---->
博客</a></div><div class="nav-item"><a href="/vue-blog/tags/" class="nav-link"><!---->
标签云</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>后端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ORM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Guava</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>加解密</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>日志</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>认证授权</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>微服务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>限流熔断</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式事务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式锁</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式任务调度</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>监控</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>容器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue-blog/blog/document/container/docker.html" aria-current="page" class="active sidebar-link">docker-基础</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue-blog/blog/document/container/docker-Oracle-12c.html" class="sidebar-link">docker-Oracle 12c</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>业务场景</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>生产环境问题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>慕课</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编辑器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其它</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page" data-v-37cc033a> <section class="tags" data-v-37cc033a><span class="tagPopup" data-v-37cc033a><a href="/vue-blog/tags/?tag=docker" class="tag" data-v-37cc033a>docker</a></span></section> <div class="content theme-default-content content__default" data-v-37cc033a><p><img src="/vue-blog/assets/img/1.84be6946.jpg" alt=""> <img src="/vue-blog/assets/img/2.6141b638.jpg" alt=""> <img src="/vue-blog/assets/img/3.12a92940.jpg" alt=""> <img src="/vue-blog/assets/img/4.38a73821.jpg" alt=""> <img src="/vue-blog/assets/img/5.d7b4411c.jpg" alt=""> <img src="/vue-blog/assets/img/6.7c5f25bf.jpg" alt=""> <img src="/vue-blog/assets/img/7.5dd2a677.jpg" alt=""> <img src="/vue-blog/assets/img/8.43c92801.jpg" alt=""> <img src="/vue-blog/assets/img/9.e410c735.jpg" alt=""> <img src="/vue-blog/assets/img/10.0195834a.jpg" alt=""> <img src="/vue-blog/assets/img/11.9d141fe9.jpg" alt=""> <img src="/vue-blog/assets/img/12.1d6913ee.jpg" alt=""> <img src="/vue-blog/assets/img/13.546693c9.jpg" alt=""> <img src="/vue-blog/assets/img/14.9fa47cc4.jpg" alt=""> <img src="/vue-blog/assets/img/15.eb70a1bf.jpg" alt=""> <img src="/vue-blog/assets/img/16.3aa19dd8.jpg" alt=""> <img src="/vue-blog/assets/img/17.ba08d998.jpg" alt=""> <img src="/vue-blog/assets/img/18.d9fd42f5.jpg" alt=""> <img src="/vue-blog/assets/img/19.bb6fcfa4.jpg" alt=""> <img src="/vue-blog/assets/img/20.6827d7cf.jpg" alt=""> <img src="/vue-blog/assets/img/21.483b9a0c.jpg" alt=""></p> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> yum remove docker <span class="token punctuation">\</span>
docker-common <span class="token punctuation">\</span>
docker-selinux <span class="token punctuation">\</span>
docker-engine

<span class="token function">sudo</span> yum <span class="token function">install</span> -y yum-utils <span class="token punctuation">\</span>
device-mapper-persistent-data <span class="token punctuation">\</span>
lvm2

<span class="token function">sudo</span> yum-config-manager <span class="token punctuation">\</span>
--add-repo <span class="token punctuation">\</span>
https://download.docker.com/linux/centos/docker-ce.repo

<span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> systemctl start docker
<span class="token function">sudo</span> docker version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="helloworld"><a href="#helloworld" class="header-anchor">#</a> helloworld</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> docker run hello-world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="镜像"><a href="#镜像" class="header-anchor">#</a> 镜像</h3> <p><img src="/vue-blog/assets/img/22.5f8fff0c.jpg" alt=""> <img src="/vue-blog/assets/img/23.2166f3c7.jpg" alt=""> <img src="/vue-blog/assets/img/24.1c7beeda.jpg" alt=""></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>// 查看进程
<span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> docker
// 查看镜像
<span class="token function">sudo</span> docker image <span class="token function">ls</span>
// 拉取镜像
<span class="token function">sudo</span> docker pull ubuntu:14.04
// 运行镜像
docker run hello-world
docker run -it centos
// 删除镜像
docker image <span class="token function">rm</span> 67759a80360c<span class="token punctuation">(</span>镜像ID<span class="token punctuation">)</span>
docker image rmi f2a91732366c<span class="token punctuation">(</span>镜像ID<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="自己实现helloworld"><a href="#自己实现helloworld" class="header-anchor">#</a> 自己实现helloworld</h3> <div class="language-c line-numbers-mode"><pre class="language-c"><code>mkdir hello<span class="token operator">-</span>world
cd hello<span class="token operator">-</span>world<span class="token operator">/</span>
vim hello<span class="token punctuation">.</span>c

<span class="token comment">// 内容</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;hello docker\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

gcc <span class="token operator">-</span><span class="token keyword">static</span> hello<span class="token punctuation">.</span>c <span class="token operator">-</span>o hello
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code>vim Dockerfile

// 内容
<span class="token keyword">FROM</span> scratch
<span class="token keyword">ADD</span> hello /
<span class="token keyword">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker build -t brotherc/hello-world <span class="token builtin class-name">.</span>
docker run brotherc/hello-world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="容器"><a href="#容器" class="header-anchor">#</a> 容器</h3> <p><img src="/vue-blog/assets/img/25.10cec35c.jpg" alt=""></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker container <span class="token function">ls</span>
docker container <span class="token function">ls</span> -a
docker container <span class="token function">ps</span> -a
docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker container <span class="token function">ls</span> -f <span class="token string">&quot;status-exited&quot;</span> -q<span class="token variable">)</span></span>
docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker container <span class="token function">ls</span> -aq<span class="token variable">)</span></span>
docker container <span class="token function">rm</span> 846b5efe98d4<span class="token punctuation">(</span>容器ID<span class="token punctuation">)</span>
docker container <span class="token function">rm</span> <span class="token number">84</span><span class="token punctuation">(</span>容器ID前缀<span class="token punctuation">)</span>
// 将已有容器提交成新的镜像
Usage: docker commit <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER <span class="token punctuation">[</span>REPOSITORY<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>
docker commit xenodochial_pare<span class="token punctuation">(</span>容器名称<span class="token punctuation">)</span> brotherc/centos-vim
docker stop 容器id或名称
docker start 容器id或名称
docker inspect 容器id或名称
docker logs 容器id或名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="基于已经存在的container创建一个image"><a href="#基于已经存在的container创建一个image" class="header-anchor">#</a> 基于已经存在的container创建一个image</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>// 运行一个已安装好vim的centos容器
docker run -it centos
yum <span class="token function">install</span> -y <span class="token function">vim</span>
<span class="token builtin class-name">exit</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>// 容器名：xenodochial_pare
docker commit xenodochial_pare brotherc/centos-vim
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="基于dockerfile创建一个image"><a href="#基于dockerfile创建一个image" class="header-anchor">#</a> 基于Dockerfile创建一个image</h3> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code>mkdir docker<span class="token punctuation">-</span>centos<span class="token punctuation">-</span>vim
cd docker<span class="token punctuation">-</span>centos<span class="token punctuation">-</span>vim/
vim Dockerfile

<span class="token keyword">FROM</span> centos
<span class="token keyword">RUN</span> yum install <span class="token punctuation">-</span>y vim

docker build <span class="token punctuation">-</span>t brotherc/centos<span class="token punctuation">-</span>vim<span class="token punctuation">-</span>new .
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> Dockerfile</h3> <h4 id="from"><a href="#from" class="header-anchor">#</a> FROM</h4> <p>尽量使用官方的image作为base image!</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> scratch <span class="token comment">#制作base image</span>
<span class="token keyword">FROM</span> centos  <span class="token comment">#使用base image</span>
<span class="token keyword">FROM</span> ubuntu<span class="token punctuation">:</span>14.04
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="label"><a href="#label" class="header-anchor">#</a> LABEL</h4> <p>Metadata不可少!</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">LABEL</span> maintainer=<span class="token string">&quot;brotherc@136.com&quot;</span>
<span class="token keyword">LABEL</span> version=<span class="token string">&quot;1.0&quot;</span>
<span class="token keyword">LABEL</span> description=<span class="token string">&quot;This is description&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="run"><a href="#run" class="header-anchor">#</a> RUN</h4> <p>为了美观，复杂的RUN请用反斜杠换行!避免无用分层，合并多条命令成一行!</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">RUN</span> yum update &amp;&amp; yum install <span class="token punctuation">-</span>y vim \ <span class="token comment">#反斜线换行</span>
    python<span class="token punctuation">-</span>dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">RUN</span> apt<span class="token punctuation">-</span>get update &amp;&amp; apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y perl \
    pwgen <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>install<span class="token punctuation">-</span>recommends &amp;&amp; rm <span class="token punctuation">-</span>rf \
    /var/lib/apt/lists/* <span class="token comment">#注意清理cache</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">RUN</span> /bin/bash <span class="token punctuation">-</span>c<span class="token string">'source $HOME/.bashrc;echo $HOME'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="workdir"><a href="#workdir" class="header-anchor">#</a> WORKDIR</h4> <p>设定当前工作目录，类似cd
用WORKDIR，不要用RUN cd!尽量使用绝对目录!</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">WORKDIR</span> /root
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">WORKDIR</span> /test <span class="token comment">#如果没有会自动创建test目录</span>
<span class="token keyword">WORKDIR</span> demo
<span class="token keyword">RUN</span> pwd       <span class="token comment">#输出结果应该是 /test/demo</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="add-and-copy"><a href="#add-and-copy" class="header-anchor">#</a> ADD and COPY</h4> <p>将本地文件添加到image里面
大部分情况，COPY优于ADD!ADD除了COPY还有额外功能(解压)!添加远程文件/目录
请使用curl或者wget!</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">ADD</span> hello /
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">ADD</span> test.tar.gz / <span class="token comment">#添加到根目录并解压</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">WORKDIR</span> /root
<span class="token keyword">ADD</span> hello test/ <span class="token comment"># /root/test/hello</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">WORKDIR</span> /root
<span class="token keyword">COPY</span> hello test/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="env"><a href="#env" class="header-anchor">#</a> ENV</h4> <p>尽量使用ENV增加可维护性!</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">ENV</span> MYSQL_VERSION 5.6 <span class="token comment">#设置常量</span>
<span class="token keyword">RUN</span> apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y mysql<span class="token punctuation">-</span>server=<span class="token string">&quot;${MYSQL_VERSION}&quot;</span> \
    &amp;&amp; rm <span class="token punctuation">-</span>rf /var/lib/apt/lists/* <span class="token comment">#引用常量</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="run-vs-cmd-vs-entrypoint"><a href="#run-vs-cmd-vs-entrypoint" class="header-anchor">#</a> RUN vs CMD vs ENTRYPOINT</h4> <p>RUN:执行命令并创建新的image layer
CMD:设置容器启动后默认执行的命令和参数
ENTRYPOINT:设置容器启动时运行的命令</p> <h4 id="shell格式"><a href="#shell格式" class="header-anchor">#</a> Shell格式</h4> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">RUN</span> apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y vim
<span class="token keyword">CMD</span> echo <span class="token string">&quot;hello docker&quot;</span>
<span class="token keyword">ENTRYPOINT</span> echo <span class="token string">&quot;hello docker&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> centos
<span class="token keyword">ENV</span> name Docker
<span class="token keyword">ENTRYPOINT</span> echo <span class="token string">&quot;hello $name&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="exec格式"><a href="#exec格式" class="header-anchor">#</a> Exec格式</h4> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">RUN</span> <span class="token punctuation">[</span><span class="token string">&quot;apt-get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;install&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-y&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vim&quot;</span><span class="token punctuation">]</span>
<span class="token keyword">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;/bin/echo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello docker&quot;</span><span class="token punctuation">]</span>
<span class="token keyword">ENTRYPOINT</span> <span class="token punctuation">[</span><span class="token string">&quot;/bin/echo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello docker&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> centos
<span class="token keyword">ENV</span> name Docker
<span class="token keyword">ENTRYPOINT</span> <span class="token punctuation">[</span><span class="token string">&quot;/bin/echo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello docker&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="dockerfile实践"><a href="#dockerfile实践" class="header-anchor">#</a> Dockerfile实践</h3> <p>Dockerfile:</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> centos
<span class="token keyword">ENV</span> name Docker
<span class="token keyword">ENTRYPOINT</span> echo <span class="token string">&quot;hello $name&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code>docker build <span class="token punctuation">-</span>t brotherc/centos<span class="token punctuation">-</span>entrypoint<span class="token punctuation">-</span>shell .
docker run brotherc/centos<span class="token punctuation">-</span>entrypoint<span class="token punctuation">-</span>shell
hello Docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Dockerfile:</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> centos
<span class="token keyword">ENV</span> name Docker
<span class="token keyword">ENTRYPOINT</span> <span class="token punctuation">[</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;echo hello $name&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code>docker build <span class="token punctuation">-</span>t brotherc/centos<span class="token punctuation">-</span>entrypoint<span class="token punctuation">-</span>exec .
docker run brotherc/centos<span class="token punctuation">-</span>entrypoint<span class="token punctuation">-</span>exec
hello Docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="cmd"><a href="#cmd" class="header-anchor">#</a> CMD</h4> <p>容器启动时默认执行的命令
如果docker run指定了其它命令，CMD命令被忽略
如果定义了多个CMD，只有最后一个会执行
Dockerfile:</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> centos
<span class="token keyword">ENV</span> name Docker
<span class="token keyword">CMD</span> echo <span class="token string">&quot;hello $name&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker build -t brotherc/centos-cmd-shell <span class="token builtin class-name">.</span>
docker run brotherc/centos-cmd-shell
hello Docker

docker run -it brotherc/centos-cmd-shell /bin/bash
无输出
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="entrypoint"><a href="#entrypoint" class="header-anchor">#</a> ENTRYPOINT</h4> <p>让容器以应用程序或者服务的形式运行
不会被忽略，一定会执行</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker run brotherc/centos-entrypoint-shell
hello Docker

docker run -it brotherc/centos-entrypoint-shell /bin/bash
hello Docker

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="镜像的发布"><a href="#镜像的发布" class="header-anchor">#</a> 镜像的发布</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker login
docker push DockerId/镜像名称
docker pull DockerId/镜像名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="分享产生image"><a href="#分享产生image" class="header-anchor">#</a> 分享产生image</h4> <p>把我们的账户link到github或bitbucket，在github上面创建一个代码仓库，把我们的dockerfile push上去，这样就做了一个关联。
只要我们这个仓库里面有dockerfile，就会自动去克隆获取到这个dockerfile然后dockerhub后台服务器会帮我们去build。
这样我们既提供了dockerfile，docker image又是dockerhub后台服务器帮我们build的，这个安全性会有很大的提升。
<img src="/vue-blog/assets/img/78.80379abd.jpg" alt=""></p> <h4 id="私有的registry"><a href="#私有的registry" class="header-anchor">#</a> 私有的registry</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker run -d -p <span class="token number">5000</span>:5000 --restart always --name registry
// 访问ip:5000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>/etc/docker/daemon.json:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;insecure-registries&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;ip:5000&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>/lib/systemd/system/docker.service:
<img src="/vue-blog/assets/img/79.9d702e81.jpg" alt=""></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">service</span> docker restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>telnet ip:5000

docker push ip:5000/镜像名称
docker pull ip:5000/镜像名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="docker-network"><a href="#docker-network" class="header-anchor">#</a> Docker Network</h3> <h4 id="基础网络概念"><a href="#基础网络概念" class="header-anchor">#</a> 基础网络概念</h4> <p><img src="/vue-blog/assets/img/32.aea8f3e7.jpg" alt=""> <img src="/vue-blog/assets/img/33.c7f60d3d.jpg" alt=""> <img src="/vue-blog/assets/img/34.b9afd031.jpg" alt=""> <img src="/vue-blog/assets/img/35.ebca7918.jpg" alt=""> <img src="/vue-blog/assets/img/36.496b000c.jpg" alt=""> <img src="/vue-blog/assets/img/37.d422d18e.jpg" alt=""> <img src="/vue-blog/assets/img/38.02c6dc8f.jpg" alt=""> <img src="/vue-blog/assets/img/39.9d4d38f3.jpg" alt=""> <img src="/vue-blog/assets/img/40.98f2473c.jpg" alt=""></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> docker run -d --name test1 busybox /bin/sh -c <span class="token string">&quot;while true; do sleep 3600; done&quot;</span>
<span class="token function">sudo</span> docker <span class="token builtin class-name">exec</span> -it test1 /bin/sh

<span class="token function">ip</span> a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> docker run -d --name test2 busybox /bin/sh -c <span class="token string">&quot;while true; do sleep 3600; done&quot;</span>
<span class="token function">sudo</span> docker <span class="token builtin class-name">exec</span> test2 <span class="token function">ip</span> a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/vue-blog/assets/img/41.0b01a599.jpg" alt=""> <img src="/vue-blog/assets/img/42.8ffed81a.jpg" alt=""> <img src="/vue-blog/assets/img/43.1713a1d3.jpg" alt=""> <img src="/vue-blog/assets/img/44.01fe79b8.jpg" alt=""> <img src="/vue-blog/assets/img/45.887c898b.jpg" alt=""> <img src="/vue-blog/assets/img/46.c1b924d0.jpg" alt=""> <img src="/vue-blog/assets/img/47.2ac716a4.jpg" alt=""> <img src="/vue-blog/assets/img/48.c6dc8ab8.jpg" alt=""> <img src="/vue-blog/assets/img/49.93ac9a92.jpg" alt=""> <img src="/vue-blog/assets/img/50.69b6c35d.jpg" alt=""> <img src="/vue-blog/assets/img/51.d5a9fbf5.jpg" alt=""> <img src="/vue-blog/assets/img/52.ed75e136.jpg" alt=""> <img src="/vue-blog/assets/img/53.b8f4d690.jpg" alt=""> <img src="/vue-blog/assets/img/54.10e2a2cf.jpg" alt=""> <img src="/vue-blog/assets/img/55.794acda7.jpg" alt=""> <img src="/vue-blog/assets/img/56.59a1de31.jpg" alt=""> <img src="/vue-blog/assets/img/57.e57449ee.jpg" alt=""> <img src="/vue-blog/assets/img/58.071534c8.jpg" alt=""> <img src="/vue-blog/assets/img/59.1572f9de.jpg" alt=""> <img src="/vue-blog/assets/img/60.824fd8f1.jpg" alt=""> <img src="/vue-blog/assets/img/61.589fef84.jpg" alt=""> <img src="/vue-blog/assets/img/62.f81e347c.jpg" alt=""> <img src="/vue-blog/assets/img/63.db6f0e7d.jpg" alt=""> <img src="/vue-blog/assets/img/64.0300c81b.jpg" alt=""> <img src="/vue-blog/assets/img/65.55d57a2e.jpg" alt=""> <img src="/vue-blog/assets/img/66.29be75b9.jpg" alt=""> <img src="/vue-blog/assets/img/67.5e0250af.jpg" alt=""> <img src="/vue-blog/assets/img/68.6cbe58b9.jpg" alt=""> <img src="/vue-blog/assets/img/69.d4c316ee.jpg" alt=""> <img src="/vue-blog/assets/img/70.e67a56d8.jpg" alt=""> <img src="/vue-blog/assets/img/71.bc756c5a.jpg" alt=""> <img src="/vue-blog/assets/img/72.ab5aeddf.jpg" alt=""> <img src="/vue-blog/assets/img/73.405f6c64.jpg" alt=""> <img src="/vue-blog/assets/img/74.46679b0c.jpg" alt=""> <img src="/vue-blog/assets/img/75.921a8ed7.jpg" alt=""> <img src="/vue-blog/assets/img/76.285e9953.jpg" alt=""> <img src="/vue-blog/assets/img/77.f923ab69.jpg" alt=""></p> <h3 id="docker的持久化存储和数据共享"><a href="#docker的持久化存储和数据共享" class="header-anchor">#</a> Docker的持久化存储和数据共享</h3> <p><img src="/vue-blog/assets/img/26.396590df.jpg" alt=""> <img src="/vue-blog/assets/img/27.8a23f014.jpg" alt=""> <img src="/vue-blog/assets/img/28.cb26923b.jpg" alt=""> <img src="/vue-blog/assets/img/29.a49aff66.jpg" alt=""></p> <h4 id="数据持久化-data-volume"><a href="#数据持久化-data-volume" class="header-anchor">#</a> 数据持久化：Data Volume</h4> <p><img src="/vue-blog/assets/img/30.e984a828.jpg" alt=""></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>//mysql镜像会默认将数据挂载到本地
<span class="token function">sudo</span> docker run -d --name mysql1 -e <span class="token assign-left variable">MYSQL_ALLOW_EMPTY_PASSWORD</span><span class="token operator">=</span>true mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> docker volume <span class="token function">ls</span>

DRIVER        VOLUME NAME
<span class="token builtin class-name">local</span>         e6ee5901156<span class="token punctuation">..</span>.

<span class="token function">sudo</span> docker volume inspect e6ee5901156<span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> docker stop mysql1
<span class="token function">sudo</span> docker <span class="token function">rm</span> mysql1
<span class="token function">sudo</span> docker volume <span class="token function">ls</span>

DRIVER        VOLUME NAME
<span class="token builtin class-name">local</span>         e6ee5901156<span class="token punctuation">..</span>.

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>//给volume指定名字
<span class="token function">sudo</span> docker run -d -v mysql:/var/lib/mysql --name mysql1 -e <span class="token assign-left variable">MYSQL_ALLOW_EMPTY_PASSWORD</span><span class="token operator">=</span>true mysql
<span class="token function">sudo</span> docker volume <span class="token function">ls</span>

DRIVER        VOLUME NAME
<span class="token builtin class-name">local</span>         mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>//让mysql容器使用已存在的volume
<span class="token function">sudo</span> docker <span class="token function">rm</span> -rf mysql1
<span class="token function">sudo</span> docker run -d -v mysql:/var/lib/mysql --name mysql2 -e <span class="token assign-left variable">MYSQL_ALLOW_EMPTY_PASSWORD</span><span class="token operator">=</span>true mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="数据持久化-bind-mouting"><a href="#数据持久化-bind-mouting" class="header-anchor">#</a> 数据持久化：Bind Mouting</h4> <p><img src="/vue-blog/assets/img/31.fcde40b7.jpg" alt="">
Dockerfile:</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> nginx<span class="token punctuation">:</span>latest
<span class="token keyword">WORKDIR</span> /usr/share/nginx/html
<span class="token keyword">COPY</span> index.html index.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker build -t brotherc/my-nginx <span class="token builtin class-name">.</span>
docker run -d -p <span class="token number">80</span>:80 --name web brotherc/my-nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker <span class="token function">rm</span> -f web
docker run -d -v <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>:/usr/share/nginx/html -p <span class="token number">80</span>:80 --name web brotherc/my-nginx
docker <span class="token builtin class-name">exec</span> -it web /bin/bash
//在容器中
<span class="token builtin class-name">cd</span> /usr/share/nginx/html
<span class="token function">touch</span> test.txt
<span class="token builtin class-name">exit</span>
//在linux中看到刚刚创建的test.txt文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div> <footer class="page-edit" data-v-37cc033a><!----> <!----></footer> <div class="page-nav" data-v-37cc033a><p class="inner" data-v-37cc033a><span class="prev" data-v-37cc033a>
        ←
        <a href="/vue-blog/blog/document/monitor/kapactior_issues.html" class="prev" data-v-37cc033a>kapacitor-issues</a></span> <span class="next" data-v-37cc033a><a href="/vue-blog/blog/document/container/docker-Oracle-12c.html" data-v-37cc033a>docker-Oracle 12c</a>→
      </span></p></div> <div id="gitalk-container" data-v-37cc033a></div> </main></div><div class="global-ui"></div></div>
    <script src="/vue-blog/assets/js/app.0b1b22d7.js" defer></script><script src="/vue-blog/assets/js/10.7f2a231e.js" defer></script><script src="/vue-blog/assets/js/5.4de21982.js" defer></script>
  </body>
</html>
