
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Brotherc">
    <title>JAVA加解密 - Brotherc</title>
    <meta name="author" content="Brotherc">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Brotherc","sameAs":["https://github.com/Brotherc"],"image":"head.jpg"},"articleBody":"Java实现Base64加密\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import org.apache.commons.codec.binary.Base64;import sun.misc.BASE64Decoder;import sun.misc.BASE64Encoder;public class Base64Test &#123;\tpublic static final String src = \"base64 test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkBase64();\t\t\t\tcommonsCodesBase64();\t\tbouncyCastleBase64();\t&#125;\t\t// 用jdk实现\tpublic static void jdkBase64()\t&#123;\t\ttry \t\t&#123;\t\t\tBASE64Encoder encoder = new BASE64Encoder();\t\t\tString encode = encoder.encode(src.getBytes());\t\t\tSystem.out.println(\"encode:\" + encode);\t\t\t\t\t\tBASE64Decoder decoder = new BASE64Decoder();\t\t\tSystem.out.println(\"decode:\" + new String(decoder.decodeBuffer(encode)));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t\t// 用Apache的common codes实现\tpublic static void commonsCodesBase64()\t&#123;\t\tbyte[] encodeBytes = Base64.encodeBase64(src.getBytes());\t\tSystem.out.println(\"common codes encode:\" + new String(encodeBytes));\t\t\t\tbyte[] dencodeBytes = Base64.decodeBase64(encodeBytes);\t\tSystem.out.println(\"common codes decode:\" + new String(dencodeBytes));\t\t\t&#125;\t\t// 用bouncy castle实现\tpublic static void bouncyCastleBase64()\t&#123;\t\tbyte[] encodeBytes = org.bouncycastle.util.encoders.Base64.encode(src.getBytes());\t\tSystem.out.println(\"bouncy castle encode:\" + new String(encodeBytes));\t\t\t\tbyte[] dencodeBytes = org.bouncycastle.util.encoders.Base64.decode(encodeBytes);\t\tSystem.out.println(\"bouncy castle decode:\" + new String(dencodeBytes));\t\t\t&#125;&#125;\n\n\nJava实现消息摘要算法加密\n\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104import java.security.MessageDigest;import java.security.Security;import org.apache.commons.codec.binary.Hex;import org.apache.commons.codec.digest.DigestUtils;import org.bouncycastle.crypto.digests.MD4Digest;import org.bouncycastle.crypto.digests.MD5Digest;import org.bouncycastle.jce.provider.BouncyCastleProvider;public class MD5Test &#123;\tpublic static final String src = \"md5 test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkMD5();\t\tjdkMD2();\t\t\t\tbcMD4();\t\tbcMD5();\t\t\t\tbc2jdkMD4();\t\t\t\tccMD5();\t\tccMD2();\t&#125;\t\t// 用jdk实现:MD5\tpublic static void jdkMD5()\t&#123;\t\ttry \t\t&#123;\t\t\tMessageDigest md = MessageDigest.getInstance(\"MD5\");\t\t\tbyte[] md5Bytes = md.digest(src.getBytes());\t\t\tSystem.out.println(\"JDK MD5:\" + Hex.encodeHexString(md5Bytes));\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t// 用jdk实现:MD2\tpublic static void jdkMD2()\t&#123;\t\ttry \t\t&#123;\t\t\tMessageDigest md = MessageDigest.getInstance(\"MD2\");\t\t\tbyte[] md2Bytes = md.digest(src.getBytes());\t\t\tSystem.out.println(\"JDK MD2:\" + Hex.encodeHexString(md2Bytes));\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t\t// 用bouncy castle实现:MD5\tpublic static void bcMD5()\t&#123;\t\tMD5Digest digest = new MD5Digest();\t\tdigest.update(src.getBytes(),0,src.getBytes().length);\t\tbyte[] md5Bytes = new byte[digest.getDigestSize()];\t\tdigest.doFinal(md5Bytes, 0);\t\tSystem.out.println(\"bouncy castle MD5:\" + org.bouncycastle.util.encoders.Hex.toHexString(md5Bytes));\t\t\t&#125;\t\t// 用bouncy castle实现:MD4\tpublic static void bcMD4()\t&#123;\t\tMD4Digest digest = new MD4Digest();\t\tdigest.update(src.getBytes(),0,src.getBytes().length);\t\tbyte[] md4Bytes = new byte[digest.getDigestSize()];\t\tdigest.doFinal(md4Bytes, 0);\t\tSystem.out.println(\"bouncy castle MD4:\" + org.bouncycastle.util.encoders.Hex.toHexString(md4Bytes));\t&#125;\t\t// 用bouncy castle与jdk结合实现:MD4\tpublic static void bc2jdkMD4()\t&#123;\t\ttry \t\t&#123;\t\t\tSecurity.addProvider(new BouncyCastleProvider());\t\t\tMessageDigest md = MessageDigest.getInstance(\"MD4\");\t\t\tbyte[] md4Bytes = md.digest(src.getBytes());\t\t\tSystem.out.println(\"bc and JDK MD4:\" + Hex.encodeHexString(md4Bytes));\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t// 用common codes实现实现:MD5\tpublic static void ccMD5()\t&#123;\t\tSystem.out.println(\"common codes MD5:\" + DigestUtils.md5Hex(src.getBytes()));\t&#125;\t\t// 用common codes实现实现:MD2\tpublic static void ccMD2()\t&#123;\t\tSystem.out.println(\"common codes MD2:\" + DigestUtils.md2Hex(src.getBytes()));\t&#125;&#125;\n\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596import java.security.MessageDigest;import java.security.Security;import org.apache.commons.codec.binary.Hex;import org.apache.commons.codec.digest.DigestUtils;import org.bouncycastle.crypto.Digest;import org.bouncycastle.crypto.digests.SHA1Digest;import org.bouncycastle.crypto.digests.SHA224Digest;import org.bouncycastle.jce.provider.BouncyCastleProvider;import java.math.BigInteger;public class SHATest &#123;\tpublic static final String src = \"sha test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkSHA1();\t\tbcSHA1();\t\tbcSHA224();\t\tbcSHA224b();\t\tgenerateSha256();\t\tccSHA1();\t&#125;\t\t// 用jdk实现:SHA1\tpublic static void jdkSHA1()\t&#123;\t\ttry \t\t&#123;\t\t\tMessageDigest md = MessageDigest.getInstance(\"SHA\");\t\t\tmd.update(src.getBytes());\t\t\tSystem.out.println(\"jdk sha-1:\" + Hex.encodeHexString(md.digest()));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t// 用bouncy castle实现:SHA1 \tpublic static void bcSHA1()\t&#123;\t\t\t\tDigest digest = new SHA1Digest();\t\tdigest.update(src.getBytes(), 0, src.getBytes().length );\t\tbyte[] sha1Bytes = new byte[digest.getDigestSize()];\t\tdigest.doFinal(sha1Bytes, 0);\t\tSystem.out.println(\"bc sha-1:\" + org.bouncycastle.util.encoders.Hex.toHexString(sha1Bytes));\t\t\t&#125;\t\t// 用bouncy castle实现:SHA224 \tpublic static void bcSHA224()\t&#123;\t\t\t\tDigest digest = new SHA224Digest();\t\tdigest.update(src.getBytes(), 0, src.getBytes().length );\t\tbyte[] sha224Bytes = new byte[digest.getDigestSize()];\t\tdigest.doFinal(sha224Bytes, 0);\t\tSystem.out.println(\"bc sha-224:\" + org.bouncycastle.util.encoders.Hex.toHexString(sha224Bytes));\t\t\t&#125;\t\t// 用bouncy castle与jdk结合实现:SHA224 \tpublic static void bcSHA224b()\t&#123;\t\t\t\ttry \t\t&#123;\t\t\tSecurity.addProvider(new BouncyCastleProvider());\t\t\tMessageDigest md = MessageDigest.getInstance(\"SHA224\");\t\t\tmd.update(src.getBytes());\t\t\tSystem.out.println(\"bc and JDK sha-224:\" + Hex.encodeHexString(md.digest()));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t\t\t&#125;\tpublic static void generateSha256() &#123;\t\tMessageDigest md = MessageDigest.getInstance(\"SHA-256\");        md.update(src.getBytes(\"UTF-8\")); // Change this to \"UTF-16\" if needed        byte[] digest = md.digest();        BigInteger bigInt = new BigInteger(1, digest);        System.out.println(\"Sha256 hash: \" + bigInt.toString(16));\t&#125;\t\t// 用common codes实现实现:SHA1\tpublic static void ccSHA1()\t&#123;\t\tSystem.out.println(\"common codes SHA1 - 1 :\" + DigestUtils.sha1Hex(src.getBytes()));\t\tSystem.out.println(\"common codes SHA1 - 2 :\" + DigestUtils.sha1Hex(src));\t&#125;\t&#125;\n\n\n\n\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465import javax.crypto.KeyGenerator;import javax.crypto.Mac;import javax.crypto.SecretKey;import javax.crypto.spec.SecretKeySpec;import org.apache.commons.codec.binary.Hex;import org.bouncycastle.crypto.digests.MD5Digest;import org.bouncycastle.crypto.macs.HMac;import org.bouncycastle.crypto.params.KeyParameter;public class HMACTest &#123;\tpublic static final String src = \"hmac test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkHmacMD5();\t\tbcHmacMD5();\t&#125;\t\t// 用jdk实现:\tpublic static void jdkHmacMD5()\t&#123;\t\ttry \t\t&#123;\t\t\t// 初始化KeyGenerator\t\t\tKeyGenerator keyGenerator = KeyGenerator.getInstance(\"HmacMD5\");\t\t\t// 产生密钥\t\t\tSecretKey secretKey = keyGenerator.generateKey();\t\t\t// 获取密钥//\t\t\tbyte[] key = secretKey.getEncoded();\t\t\tbyte[] key = Hex.decodeHex(new char[]&#123;'1','2','3','4','5','6','7','8','9','a','b','c','d','e' &#125;);\t\t\t\t\t\t// 还原密钥\t\t\tSecretKey restoreSecretKey = new SecretKeySpec(key, \"HmacMD5\");\t\t\t// 实例化MAC\t\t\tMac mac = Mac.getInstance(restoreSecretKey.getAlgorithm());\t\t\t// 初始化MAC\t\t\tmac.init(restoreSecretKey);\t\t\t// 执行摘要\t\t\tbyte[] hmacMD5Bytes = mac.doFinal(src.getBytes());\t\t\tSystem.out.println(\"jdk hmacMD5:\" + Hex.encodeHexString(hmacMD5Bytes));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t// 用bouncy castle实现:\tpublic static void bcHmacMD5()\t&#123;\t\tHMac hmac = new HMac(new MD5Digest());\t\t// 必须是16进制的字符，长度必须是2的倍数\t\thmac.init(new KeyParameter(org.bouncycastle.util.encoders.Hex.decode(\"123456789abcde\")));\t\thmac.update(src.getBytes(), 0, src.getBytes().length);\t\t\t\t// 执行摘要\t\tbyte[] hmacMD5Bytes = new byte[hmac.getMacSize()];\t\thmac.doFinal(hmacMD5Bytes, 0);\t\tSystem.out.println(\"bc hmacMD5:\" + org.bouncycastle.util.encoders.Hex.toHexString(hmacMD5Bytes));\t\t\t&#125;&#125;\n\n\nJava实现对称加密\n软件、硬件\n加密密钥=解密密钥\n初等、DES(3DES)、AES、PBE、IDEA\n\n\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798import java.security.Key;import java.security.Security;import javax.crypto.Cipher;import javax.crypto.KeyGenerator;import javax.crypto.SecretKey;import javax.crypto.SecretKeyFactory;import javax.crypto.spec.DESKeySpec;import org.apache.commons.codec.binary.Hex;import org.bouncycastle.jce.provider.BouncyCastleProvider;public class DESTest &#123;\tpublic static final String src = \"des test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkDES();\t\tbcDES();\t&#125;\t\t// 用jdk实现:\tpublic static void jdkDES()\t&#123;\t\ttry \t\t&#123;\t\t\t// 生成KEY\t\t\tKeyGenerator keyGenerator = KeyGenerator.getInstance(\"DES\");\t\t\t\t\t\tkeyGenerator.init(56);\t\t\t// 产生密钥\t\t\tSecretKey secretKey = keyGenerator.generateKey();\t\t\t// 获取密钥\t\t\tbyte[] bytesKey = secretKey.getEncoded();\t\t\t\t\t\t\t\t\t// KEY转换\t\t\tDESKeySpec desKeySpec = new DESKeySpec(bytesKey);\t\t\tSecretKeyFactory factory = SecretKeyFactory.getInstance(\"DES\");\t\t\tKey convertSecretKey = factory.generateSecret(desKeySpec);\t\t\t\t\t\t\t\t\t// 加密\t\t\tCipher cipher = Cipher.getInstance(\"DES/ECB/PKCS5Padding\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"jdk des encrypt:\" + Hex.encodeHexString(result));\t\t\t\t\t\t// 解密\t\t\tcipher.init(Cipher.DECRYPT_MODE, convertSecretKey);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"jdk des decrypt:\" + new String(result));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t// 用bouncy castle实现:\tpublic static void bcDES()\t&#123;\t\ttry \t\t&#123;\t\t\tSecurity.addProvider(new BouncyCastleProvider());\t\t\t\t\t\t// 生成KEY\t\t\tKeyGenerator keyGenerator = KeyGenerator.getInstance(\"DES\", \"BC\");\t\t\tkeyGenerator.getProvider();\t\t\tkeyGenerator.init(56);\t\t\t// 产生密钥\t\t\tSecretKey secretKey = keyGenerator.generateKey();\t\t\t// 获取密钥\t\t\tbyte[] bytesKey = secretKey.getEncoded();\t\t\t\t\t\t\t\t\t// KEY转换\t\t\tDESKeySpec desKeySpec = new DESKeySpec(bytesKey);\t\t\tSecretKeyFactory factory = SecretKeyFactory.getInstance(\"DES\");\t\t\tKey convertSecretKey = factory.generateSecret(desKeySpec);\t\t\t\t\t\t\t\t\t// 加密\t\t\tCipher cipher = Cipher.getInstance(\"DES/ECB/PKCS5Padding\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"bc des encrypt:\" + Hex.encodeHexString(result));\t\t\t\t\t\t// 解密\t\t\tcipher.init(Cipher.DECRYPT_MODE, convertSecretKey);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"bc des decrypt:\" + new String(result));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;&#125;\n\n\n\n\n\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102import java.security.Key;import java.security.SecureRandom;import java.security.Security;import javax.crypto.Cipher;import javax.crypto.KeyGenerator;import javax.crypto.SecretKey;import javax.crypto.SecretKeyFactory;import javax.crypto.spec.DESKeySpec;import javax.crypto.spec.DESedeKeySpec;import org.apache.commons.codec.binary.Hex;import org.bouncycastle.jce.provider.BouncyCastleProvider;public class DES3Test &#123;\tpublic static final String src = \"3des test\";\tpublic static void main(String[] args) \t&#123;\t\tjdk3DES();\t\tbc3DES();\t&#125;\t\t// 用jdk实现:\tpublic static void jdk3DES()\t&#123;\t\ttry \t\t&#123;\t\t\t// 生成KEY\t\t\tKeyGenerator keyGenerator = KeyGenerator.getInstance(\"DESede\");\t\t\t\t// 必须长度是：112或168//\t\t\tkeyGenerator.init(168);\t\t\tkeyGenerator.init(new SecureRandom());\t\t\t// 产生密钥\t\t\tSecretKey secretKey = keyGenerator.generateKey();\t\t\t// 获取密钥\t\t\tbyte[] bytesKey = secretKey.getEncoded();\t\t\t\t\t\t\t\t\t// KEY转换\t\t\tDESedeKeySpec desKeySpec = new DESedeKeySpec(bytesKey);\t\t\tSecretKeyFactory factory = SecretKeyFactory.getInstance(\"DESede\");\t\t\tKey convertSecretKey = factory.generateSecret(desKeySpec);\t\t\t\t\t\t\t\t\t// 加密\t\t\tCipher cipher = Cipher.getInstance(\"DESede/ECB/PKCS5Padding\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"jdk 3des encrypt:\" + Hex.encodeHexString(result));\t\t\t\t\t\t// 解密\t\t\tcipher.init(Cipher.DECRYPT_MODE, convertSecretKey);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"jdk 3des decrypt:\" + new String(result));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t// 用bouncy castle实现:\tpublic static void bc3DES()\t&#123;\t\ttry \t\t&#123;\t\t\tSecurity.addProvider(new BouncyCastleProvider());\t\t\t\t\t\t// 生成KEY\t\t\tKeyGenerator keyGenerator = KeyGenerator.getInstance(\"DESede\", \"BC\");\t\t\tkeyGenerator.getProvider();\t\t\tkeyGenerator.init(168);\t\t\t// 产生密钥\t\t\tSecretKey secretKey = keyGenerator.generateKey();\t\t\t// 获取密钥\t\t\tbyte[] bytesKey = secretKey.getEncoded();\t\t\t\t\t\t\t\t\t// KEY转换\t\t\tDESedeKeySpec desKeySpec = new DESedeKeySpec(bytesKey);\t\t\tSecretKeyFactory factory = SecretKeyFactory.getInstance(\"DESede\");\t\t\tKey convertSecretKey = factory.generateSecret(desKeySpec);\t\t\t\t\t\t\t\t\t// 加密\t\t\tCipher cipher = Cipher.getInstance(\"DESede/ECB/PKCS5Padding\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"bc 3des encrypt:\" + Hex.encodeHexString(result));\t\t\t\t\t\t// 解密\t\t\tcipher.init(Cipher.DECRYPT_MODE, convertSecretKey);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"bc 3des decrypt:\" + new String(result));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;&#125;\n\nAES是目前使用最多的对称加密算法\nAES的优势之一是至今尚未被破解\nAES通常用于移动通信系统加密以及基于SSH协议的软件(SSH Client、secureCRT)\n\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293import java.security.Key;import java.security.Security;import javax.crypto.Cipher;import javax.crypto.KeyGenerator;import javax.crypto.SecretKey;import javax.crypto.spec.SecretKeySpec;import org.apache.commons.codec.binary.Hex;import org.bouncycastle.jce.provider.BouncyCastleProvider;public class AESTest &#123;\tpublic static final String src = \"aes test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkAES();\t\tbcAES();\t&#125;\t\t// 用jdk实现:\tpublic static void jdkAES()\t&#123;\t\ttry \t\t&#123;\t\t\t// 生成KEY\t\t\tKeyGenerator keyGenerator = KeyGenerator.getInstance(\"AES\");\t\t\t\t\t\tkeyGenerator.init(128);\t\t\t// 产生密钥\t\t\tSecretKey secretKey = keyGenerator.generateKey();\t\t\t// 获取密钥\t\t\tbyte[] keyBytes = secretKey.getEncoded();\t\t\t\t\t\t\t\t\t// KEY转换\t\t\tKey key = new SecretKeySpec(keyBytes, \"AES\");\t\t\t\t\t\t\t\t\t// 加密\t\t\tCipher cipher = Cipher.getInstance(\"AES/ECB/PKCS5Padding\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, key);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"jdk aes encrypt:\" + Hex.encodeHexString(result));\t\t\t\t\t\t// 解密\t\t\tcipher.init(Cipher.DECRYPT_MODE, key);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"jdk aes decrypt:\" + new String(result));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t\t// 用bouncy castle实现:\tpublic static void bcAES()\t&#123;\t\ttry \t\t&#123;\t\t\tSecurity.addProvider(new BouncyCastleProvider());\t\t\t\t\t\t// 生成KEY\t\t\tKeyGenerator keyGenerator = KeyGenerator.getInstance(\"AES\", \"BC\");\t\t\t\tkeyGenerator.getProvider();\t\t\tkeyGenerator.init(128);\t\t\t// 产生密钥\t\t\tSecretKey secretKey = keyGenerator.generateKey();\t\t\t// 获取密钥\t\t\tbyte[] keyBytes = secretKey.getEncoded();\t\t\t\t\t\t\t\t\t// KEY转换\t\t\tKey key = new SecretKeySpec(keyBytes, \"AES\");\t\t\t\t\t\t\t\t\t// 加密\t\t\tCipher cipher = Cipher.getInstance(\"AES/ECB/PKCS5Padding\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, key);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"bc aes encrypt:\" + Hex.encodeHexString(result));\t\t\t\t\t\t// 解密\t\t\tcipher.init(Cipher.DECRYPT_MODE, key);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"bc aes decrypt:\" + new String(result));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;&#125;\n\n\n\n\n\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import java.security.Key;import java.security.SecureRandom;import javax.crypto.Cipher;import javax.crypto.SecretKeyFactory;import javax.crypto.spec.PBEKeySpec;import javax.crypto.spec.PBEParameterSpec;import org.apache.commons.codec.binary.Hex;public class PBETest &#123;\tpublic static final String src = \"pbe test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkPBE();\t&#125;\t// 用jdk实现:\tpublic static void jdkPBE()\t&#123;\t\ttry \t\t&#123;\t\t\t// 初始化盐\t\t\tSecureRandom random = new SecureRandom();\t\t\tbyte[] salt = random.generateSeed(8);\t\t\t\t\t\t// 口令与密钥\t\t\tString password = \"timliu\";\t\t\tPBEKeySpec pbeKeySpec = new PBEKeySpec(password.toCharArray()); \t\t\tSecretKeyFactory factory = SecretKeyFactory.getInstance(\"PBEWITHMD5andDES\");\t\t\tKey key = factory.generateSecret(pbeKeySpec);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 加密\t\t\tPBEParameterSpec pbeParameterSpac = new PBEParameterSpec(salt, 100);\t\t\tCipher cipher = Cipher.getInstance(\"PBEWITHMD5andDES\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, key, pbeParameterSpac);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"jdk pbe encrypt:\" + Hex.encodeHexString(result));\t\t\t\t\t\t// 解密\t\t\tcipher.init(Cipher.DECRYPT_MODE, key, pbeParameterSpac);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"jdk pbe decrypt:\" + new String(result));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;\t&#125;\nJava实现非对称加密\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485import java.security.KeyFactory;import java.security.KeyPair;import java.security.KeyPairGenerator;import java.security.PrivateKey;import java.security.PublicKey;import java.security.spec.X509EncodedKeySpec;import javax.crypto.Cipher;import javax.crypto.KeyAgreement;import javax.crypto.SecretKey;import javax.crypto.interfaces.DHPublicKey;import javax.crypto.spec.DHParameterSpec;import org.apache.commons.codec.binary.Base64;import com.sun.org.apache.xalan.internal.utils.Objects;public class DHTest &#123;\tpublic static final String src = \"dh test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkDH();\t&#125;\t\t// jdk实现：\tpublic static void jdkDH()\t&#123;\t\t\t\ttry \t\t&#123;\t\t\t// 1.初始化发送方密钥\t\t\tKeyPairGenerator senderKeyPairGenerator = KeyPairGenerator.getInstance(\"DH\");\t\t\tsenderKeyPairGenerator.initialize(512);\t\t\tKeyPair senderKeyPair = senderKeyPairGenerator.generateKeyPair();\t\t\t// 发送方公钥，发送给接收方（网络、文件。。。）\t\t\tbyte[] senderPublicKeyEnc = senderKeyPair.getPublic().getEncoded();\t\t\t\t\t\t// 2.初始化接收方密钥\t\t\tKeyFactory receiverKeyFactory = KeyFactory.getInstance(\"DH\");\t\t\tX509EncodedKeySpec x509EncodedKeySpec = new X509EncodedKeySpec(senderPublicKeyEnc);\t\t\tPublicKey receiverPublicKey = receiverKeyFactory.generatePublic(x509EncodedKeySpec);\t\t\tDHParameterSpec dhParameterSpec = ((DHPublicKey) receiverPublicKey).getParams();\t\t\tKeyPairGenerator receiverKeyPairGenerator = KeyPairGenerator.getInstance(\"DH\");\t\t\treceiverKeyPairGenerator.initialize(dhParameterSpec);\t\t\tKeyPair receiverKeypair = receiverKeyPairGenerator.generateKeyPair();\t\t\tPrivateKey receiverPrivateKey = receiverKeypair.getPrivate();\t\t\tbyte[] receiverPublicKeyEnc = receiverKeypair.getPublic().getEncoded();\t\t\t\t\t\t// 3.密钥构建\t\t\tKeyAgreement receiverKeyAgreement = KeyAgreement.getInstance(\"DH\");\t\t\treceiverKeyAgreement.init(receiverPrivateKey);\t\t\treceiverKeyAgreement.doPhase(receiverPublicKey, true);\t\t\tSecretKey receiverDesKey = receiverKeyAgreement.generateSecret(\"DES\");\t\t\t\t\t\tKeyFactory senderKeyFactory = KeyFactory.getInstance(\"DH\");\t\t\tx509EncodedKeySpec = new X509EncodedKeySpec(receiverPublicKeyEnc);\t\t\tPublicKey senderPublicKey = senderKeyFactory.generatePublic(x509EncodedKeySpec);\t\t\tKeyAgreement senderKeyAgreement = KeyAgreement.getInstance(\"DH\");\t\t\tsenderKeyAgreement.init(senderKeyPair.getPrivate());\t\t\tsenderKeyAgreement.doPhase(senderPublicKey, true);\t\t\tSecretKey senderDesKey = senderKeyAgreement.generateSecret(\"DES\");\t\t\tif(Objects.equals(receiverDesKey, senderDesKey))\t\t\t&#123;\t\t\t\tSystem.out.println(\"双方密钥相同。\");\t\t\t&#125;\t\t\t\t\t\t// 4.加密\t\t\tCipher cipher = Cipher.getInstance(\"DES\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, senderDesKey);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"bc dh encrypt:\" + Base64.encodeBase64String(result));\t\t\t\t\t\t// 5.解密\t\t\tcipher.init(Cipher.DECRYPT_MODE, receiverDesKey);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"bc dh decrypt:\" + new String(result));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\t\t\t\te.printStackTrace();\t\t&#125;\t&#125;&#125;\n\n\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788import java.security.KeyFactory;import java.security.KeyPair;import java.security.KeyPairGenerator;import java.security.PrivateKey;import java.security.PublicKey;import java.security.interfaces.RSAPrivateKey;import java.security.interfaces.RSAPublicKey;import java.security.spec.PKCS8EncodedKeySpec;import java.security.spec.X509EncodedKeySpec;import javax.crypto.Cipher;import javax.crypto.KeyAgreement;import javax.crypto.SecretKey;import javax.crypto.interfaces.DHPublicKey;import javax.crypto.spec.DHParameterSpec;import org.apache.commons.codec.binary.Base64;import com.sun.org.apache.xalan.internal.utils.Objects;public class RSATest &#123;\tpublic static final String src = \"rsa test\";\tpublic static void main(String[] args) \t&#123;\t\tjdkRSA();\t&#125;\t\t// jdk实现：\tpublic static void jdkRSA()\t&#123;\t\t\t\ttry \t\t&#123;\t\t\t// 1.初始化发送方密钥\t\t\tKeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(\"RSA\");\t\t\tkeyPairGenerator.initialize(512);\t\t\tKeyPair keyPair = keyPairGenerator.generateKeyPair();\t\t\tRSAPublicKey rsaPublicKey = (RSAPublicKey) keyPair.getPublic();\t\t\tRSAPrivateKey rsaPrivateKey = (RSAPrivateKey) keyPair.getPrivate();\t\t\tSystem.out.println(\"Public Key:\" + Base64.encodeBase64String(rsaPublicKey.getEncoded()));\t\t\tSystem.out.println(\"Private Key:\" + Base64.encodeBase64String(rsaPrivateKey.getEncoded()));\t\t\t\t\t\t// 2.私钥加密、公钥解密 ---- 加密\t\t\tPKCS8EncodedKeySpec pkcs8EncodedKeySpec = new PKCS8EncodedKeySpec(rsaPrivateKey.getEncoded());\t\t\tKeyFactory keyFactory = KeyFactory.getInstance(\"RSA\");\t\t\tPrivateKey privateKey = keyFactory.generatePrivate(pkcs8EncodedKeySpec);\t\t\tCipher cipher = Cipher.getInstance(\"RSA\");\t\t\tcipher.init(Cipher.ENCRYPT_MODE, privateKey);\t\t\tbyte[] result = cipher.doFinal(src.getBytes());\t\t\tSystem.out.println(\"私钥加密、公钥解密 ---- 加密:\" + Base64.encodeBase64String(result));\t\t\t\t\t\t// 3.私钥加密、公钥解密 ---- 解密\t\t\tX509EncodedKeySpec x509EncodedKeySpec = new X509EncodedKeySpec(rsaPublicKey.getEncoded());\t\t\tkeyFactory = KeyFactory.getInstance(\"RSA\");\t\t\tPublicKey publicKey = keyFactory.generatePublic(x509EncodedKeySpec);\t\t\tcipher = Cipher.getInstance(\"RSA\");\t\t\tcipher.init(Cipher.DECRYPT_MODE, publicKey);\t\t\tresult = cipher.doFinal(result);\t\t\tSystem.out.println(\"私钥加密、公钥解密 ---- 解密:\" + new String(result));\t\t\t\t\t\t\t\t\t\t\t\t// 4.公钥加密、私钥解密 ---- 加密\t\t\tX509EncodedKeySpec x509EncodedKeySpec2 = new X509EncodedKeySpec(rsaPublicKey.getEncoded());\t\t\tKeyFactory keyFactory2 = KeyFactory.getInstance(\"RSA\");\t\t\tPublicKey publicKey2 = keyFactory2.generatePublic(x509EncodedKeySpec2);\t\t\tCipher cipher2 = Cipher.getInstance(\"RSA\");\t\t\tcipher2.init(Cipher.ENCRYPT_MODE, publicKey2);\t\t\tbyte[] result2 = cipher2.doFinal(src.getBytes());\t\t\tSystem.out.println(\"公钥加密、私钥解密 ---- 加密:\" + Base64.encodeBase64String(result2));\t\t\t\t\t\t// 5.私钥解密、公钥加密 ---- 解密\t\t\tPKCS8EncodedKeySpec pkcs8EncodedKeySpec5 = new PKCS8EncodedKeySpec(rsaPrivateKey.getEncoded());\t\t\tKeyFactory keyFactory5 = KeyFactory.getInstance(\"RSA\");\t\t\tPrivateKey privateKey5 = keyFactory5.generatePrivate(pkcs8EncodedKeySpec5);\t\t\tCipher cipher5 = Cipher.getInstance(\"RSA\");\t\t\tcipher5.init(Cipher.DECRYPT_MODE, privateKey5);\t\t\tbyte[] result5 = cipher5.doFinal(result2);\t\t\tSystem.out.println(\"公钥加密、私钥解密 ---- 解密:\" + new String(result5));\t\t\t\t\t&#125; catch (Exception e) &#123;\t\t\te.printStackTrace();\t\t&#125;\t&#125;&#125;\n\n\n\n\n\n\n参考：https://github.com/Tim9Liu9/java_security\n","dateCreated":"2020-08-19T12:27:02+08:00","dateModified":"2020-08-19T12:26:40+08:00","datePublished":"2020-08-19T12:27:02+08:00","description":"","headline":"JAVA加解密","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2020/08/19/JAVA加解密/"},"publisher":{"@type":"Organization","name":"Brotherc","sameAs":["https://github.com/Brotherc"],"image":"head.jpg","logo":{"@type":"ImageObject","url":"head.jpg"}},"url":"http://yoursite.com/2020/08/19/JAVA加解密/","keywords":"加密"}</script>
    <meta name="description" content="Java实现Base64加密                123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import org.apache.commons.codec.binary.Base64;import sun.mi">
<meta name="keywords" content="加密">
<meta property="og:type" content="blog">
<meta property="og:title" content="JAVA加解密">
<meta property="og:url" content="http://yoursite.com/2020/08/19/JAVA加解密/index.html">
<meta property="og:site_name" content="Brotherc">
<meta property="og:description" content="Java实现Base64加密                123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import org.apache.commons.codec.binary.Base64;import sun.mi">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/1.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/2.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/3.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/4.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/5.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/6.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/7.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/8.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/9.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/10.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/11.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/12.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/13.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/14.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/15.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/16.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/17.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/18.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/28.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/29.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/30.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/31.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/32.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/33.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/34.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/35.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/36.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/37.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/38.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/19.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/20.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/21.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/22.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/23.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/24.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/25.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/26.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/27.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/39.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/40.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/41.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/42.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/43.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/44.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/45.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/46.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/47.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/48.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/49.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/50.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/51.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/52.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/53.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/54.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/55.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/56.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/57.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/58.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/59.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/60.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/61.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/62.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/62.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/63.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/64.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/65.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/66.jpg">
<meta property="og:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/67.jpg">
<meta property="og:updated_time" content="2020-08-19T04:26:40.292Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JAVA加解密">
<meta name="twitter:description" content="Java实现Base64加密                123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import org.apache.commons.codec.binary.Base64;import sun.mi">
<meta name="twitter:image" content="http://yoursite.com/assets/加密/JAVA实现对称加密/1.jpg">
    
    
        
    
    
        <meta property="og:image" content="http://yoursite.com/assets/images/head.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-c4ozcsklz4kht2pebhp44xorvyverh23toayhn7i6ubrpyedak24hv1v0hyd.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Brotherc</a>
    </div>
    
        
            <a class="header-right-picture " href="#about">
        
        
            <img class="header-picture" src="/assets/images/head.jpg" alt="作者的图片">
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/head.jpg" alt="作者的图片">
                </a>
                <h4 class="sidebar-profile-name">Brotherc</h4>
                
                    <h5 class="sidebar-profile-bio"><p>java development</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/ " title="首页">
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" title="分类">
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" title="标签">
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link open-algolia-search" href="/all-archives" title="归档">
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" title="关于">
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/Brotherc" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            JAVA加解密
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-08-19T12:27:02+08:00">
	
		    8月 19, 2020
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h2 id="Java实现Base64加密"><a href="#Java实现Base64加密" class="headerlink" title="Java实现Base64加密"></a>Java实现Base64加密</h2><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/1.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/1.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/2.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/2.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/3.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/3.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/4.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/4.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/5.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/5.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/6.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/6.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/7.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/7.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/8.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/8.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/9.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/9.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/10.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/10.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/11.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/11.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/12.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/12.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/13.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/13.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/14.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/14.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/15.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/15.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/16.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/16.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;</span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Base64Test</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"base64 test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkBase64();</span><br><span class="line">		</span><br><span class="line">		commonsCodesBase64();</span><br><span class="line"></span><br><span class="line">		bouncyCastleBase64();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkBase64</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			BASE64Encoder encoder = <span class="keyword">new</span> BASE64Encoder();</span><br><span class="line">			String encode = encoder.encode(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"encode:"</span> + encode);</span><br><span class="line">			</span><br><span class="line">			BASE64Decoder decoder = <span class="keyword">new</span> BASE64Decoder();</span><br><span class="line">			System.out.println(<span class="string">"decode:"</span> + <span class="keyword">new</span> String(decoder.decodeBuffer(encode)));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用Apache的common codes实现</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">commonsCodesBase64</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">byte</span>[] encodeBytes = Base64.encodeBase64(src.getBytes());</span><br><span class="line">		System.out.println(<span class="string">"common codes encode:"</span> + <span class="keyword">new</span> String(encodeBytes));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] dencodeBytes = Base64.decodeBase64(encodeBytes);</span><br><span class="line">		System.out.println(<span class="string">"common codes decode:"</span> + <span class="keyword">new</span> String(dencodeBytes));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 用bouncy castle实现</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bouncyCastleBase64</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">byte</span>[] encodeBytes = org.bouncycastle.util.encoders.Base64.encode(src.getBytes());</span><br><span class="line">		System.out.println(<span class="string">"bouncy castle encode:"</span> + <span class="keyword">new</span> String(encodeBytes));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] dencodeBytes = org.bouncycastle.util.encoders.Base64.decode(encodeBytes);</span><br><span class="line">		System.out.println(<span class="string">"bouncy castle decode:"</span> + <span class="keyword">new</span> String(dencodeBytes));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/17.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/17.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/18.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/18.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<h2 id="Java实现消息摘要算法加密"><a href="#Java实现消息摘要算法加密" class="headerlink" title="Java实现消息摘要算法加密"></a>Java实现消息摘要算法加密</h2><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/28.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/28.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/29.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/29.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/30.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/30.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.digest.DigestUtils;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.MD4Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.MD5Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MD5Test</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"md5 test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkMD5();</span><br><span class="line">		jdkMD2();</span><br><span class="line">		</span><br><span class="line">		bcMD4();</span><br><span class="line">		bcMD5();</span><br><span class="line">		</span><br><span class="line">		bc2jdkMD4();</span><br><span class="line">		</span><br><span class="line">		ccMD5();</span><br><span class="line">		ccMD2();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:MD5</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">			<span class="keyword">byte</span>[] md5Bytes = md.digest(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"JDK MD5:"</span> + Hex.encodeHexString(md5Bytes));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:MD2</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkMD2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"MD2"</span>);</span><br><span class="line">			<span class="keyword">byte</span>[] md2Bytes = md.digest(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"JDK MD2:"</span> + Hex.encodeHexString(md2Bytes));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:MD5</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		MD5Digest digest = <span class="keyword">new</span> MD5Digest();</span><br><span class="line">		digest.update(src.getBytes(),<span class="number">0</span>,src.getBytes().length);</span><br><span class="line">		<span class="keyword">byte</span>[] md5Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[digest.getDigestSize()];</span><br><span class="line">		digest.doFinal(md5Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bouncy castle MD5:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(md5Bytes));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 用bouncy castle实现:MD4</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcMD4</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		MD4Digest digest = <span class="keyword">new</span> MD4Digest();</span><br><span class="line">		digest.update(src.getBytes(),<span class="number">0</span>,src.getBytes().length);</span><br><span class="line">		<span class="keyword">byte</span>[] md4Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[digest.getDigestSize()];</span><br><span class="line">		digest.doFinal(md4Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bouncy castle MD4:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(md4Bytes));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle与jdk结合实现:MD4</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bc2jdkMD4</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"MD4"</span>);</span><br><span class="line">			<span class="keyword">byte</span>[] md4Bytes = md.digest(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc and JDK MD4:"</span> + Hex.encodeHexString(md4Bytes));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用common codes实现实现:MD5</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ccMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"common codes MD5:"</span> + DigestUtils.md5Hex(src.getBytes()));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用common codes实现实现:MD2</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ccMD2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"common codes MD2:"</span> + DigestUtils.md2Hex(src.getBytes()));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/31.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/31.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/32.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/32.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.digest.DigestUtils;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.SHA1Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.SHA224Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SHATest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"sha test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkSHA1();</span><br><span class="line">		bcSHA1();</span><br><span class="line">		bcSHA224();</span><br><span class="line">		bcSHA224b();</span><br><span class="line">		generateSha256();</span><br><span class="line">		ccSHA1();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:SHA1</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkSHA1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"SHA"</span>);</span><br><span class="line">			md.update(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk sha-1:"</span> + Hex.encodeHexString(md.digest()));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:SHA1 </span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcSHA1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		</span><br><span class="line">		Digest digest = <span class="keyword">new</span> SHA1Digest();</span><br><span class="line">		digest.update(src.getBytes(), <span class="number">0</span>, src.getBytes().length );</span><br><span class="line">		<span class="keyword">byte</span>[] sha1Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[digest.getDigestSize()];</span><br><span class="line">		digest.doFinal(sha1Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bc sha-1:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(sha1Bytes));		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 用bouncy castle实现:SHA224 </span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcSHA224</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		</span><br><span class="line">		Digest digest = <span class="keyword">new</span> SHA224Digest();</span><br><span class="line">		digest.update(src.getBytes(), <span class="number">0</span>, src.getBytes().length );</span><br><span class="line">		<span class="keyword">byte</span>[] sha224Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[digest.getDigestSize()];</span><br><span class="line">		digest.doFinal(sha224Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bc sha-224:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(sha224Bytes));		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle与jdk结合实现:SHA224 </span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcSHA224b</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			MessageDigest md = MessageDigest.getInstance(<span class="string">"SHA224"</span>);</span><br><span class="line">			md.update(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc and JDK sha-224:"</span> + Hex.encodeHexString(md.digest()));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">generateSha256</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		MessageDigest md = MessageDigest.getInstance(<span class="string">"SHA-256"</span>);</span><br><span class="line"></span><br><span class="line">        md.update(src.getBytes(<span class="string">"UTF-8"</span>)); <span class="comment">// Change this to "UTF-16" if needed</span></span><br><span class="line">        <span class="keyword">byte</span>[] digest = md.digest();</span><br><span class="line">        BigInteger bigInt = <span class="keyword">new</span> BigInteger(<span class="number">1</span>, digest);</span><br><span class="line">        System.out.println(<span class="string">"Sha256 hash: "</span> + bigInt.toString(<span class="number">16</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用common codes实现实现:SHA1</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ccSHA1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"common codes SHA1 - 1 :"</span> + DigestUtils.sha1Hex(src.getBytes()));</span><br><span class="line">		System.out.println(<span class="string">"common codes SHA1 - 2 :"</span> + DigestUtils.sha1Hex(src));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/33.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/33.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/34.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/34.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/35.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/35.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/36.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/36.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Mac;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.digests.MD5Digest;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.macs.HMac;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.params.KeyParameter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HMACTest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"hmac test"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkHmacMD5();</span><br><span class="line">		bcHmacMD5();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkHmacMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 初始化KeyGenerator</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"HmacMD5"</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line"><span class="comment">//			byte[] key = secretKey.getEncoded();</span></span><br><span class="line">			<span class="keyword">byte</span>[] key = Hex.decodeHex(<span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span> &#125;);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 还原密钥</span></span><br><span class="line">			SecretKey restoreSecretKey = <span class="keyword">new</span> SecretKeySpec(key, <span class="string">"HmacMD5"</span>);</span><br><span class="line">			<span class="comment">// 实例化MAC</span></span><br><span class="line">			Mac mac = Mac.getInstance(restoreSecretKey.getAlgorithm());</span><br><span class="line">			<span class="comment">// 初始化MAC</span></span><br><span class="line">			mac.init(restoreSecretKey);</span><br><span class="line">			<span class="comment">// 执行摘要</span></span><br><span class="line">			<span class="keyword">byte</span>[] hmacMD5Bytes = mac.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk hmacMD5:"</span> + Hex.encodeHexString(hmacMD5Bytes));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcHmacMD5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		HMac hmac = <span class="keyword">new</span> HMac(<span class="keyword">new</span> MD5Digest());</span><br><span class="line">		<span class="comment">// 必须是16进制的字符，长度必须是2的倍数</span></span><br><span class="line">		hmac.init(<span class="keyword">new</span> KeyParameter(org.bouncycastle.util.encoders.Hex.decode(<span class="string">"123456789abcde"</span>)));</span><br><span class="line">		hmac.update(src.getBytes(), <span class="number">0</span>, src.getBytes().length);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 执行摘要</span></span><br><span class="line">		<span class="keyword">byte</span>[] hmacMD5Bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[hmac.getMacSize()];</span><br><span class="line">		hmac.doFinal(hmacMD5Bytes, <span class="number">0</span>);</span><br><span class="line">		System.out.println(<span class="string">"bc hmacMD5:"</span> + org.bouncycastle.util.encoders.Hex.toHexString(hmacMD5Bytes));</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/37.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/37.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/38.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/38.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<h2 id="Java实现对称加密"><a href="#Java实现对称加密" class="headerlink" title="Java实现对称加密"></a>Java实现对称加密</h2><ul>
<li>软件、硬件</li>
<li>加密密钥=解密密钥</li>
<li>初等、DES(3DES)、AES、PBE、IDEA</li>
</ul>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/19.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/19.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DESTest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"des test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkDES();</span><br><span class="line">		bcDES();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkDES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"DES"</span>);			</span><br><span class="line">			keyGenerator.init(<span class="number">56</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] bytesKey = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			DESKeySpec desKeySpec = <span class="keyword">new</span> DESKeySpec(bytesKey);</span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">			Key convertSecretKey = factory.generateSecret(desKeySpec);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DES/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk des encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, convertSecretKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"jdk des decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcDES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"DES"</span>, <span class="string">"BC"</span>);</span><br><span class="line">			keyGenerator.getProvider();</span><br><span class="line">			keyGenerator.init(<span class="number">56</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] bytesKey = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			DESKeySpec desKeySpec = <span class="keyword">new</span> DESKeySpec(bytesKey);</span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">			Key convertSecretKey = factory.generateSecret(desKeySpec);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DES/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc des encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, convertSecretKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"bc des decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/20.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/20.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/21.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/21.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/22.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/22.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/23.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/23.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/24.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/24.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/25.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/25.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.SecureRandom;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESedeKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DES3Test</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"3des test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdk3DES();</span><br><span class="line">		bc3DES();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdk3DES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"DESede"</span>);	</span><br><span class="line">			<span class="comment">// 必须长度是：112或168</span></span><br><span class="line"><span class="comment">//			keyGenerator.init(168);</span></span><br><span class="line">			keyGenerator.init(<span class="keyword">new</span> SecureRandom());</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] bytesKey = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			DESedeKeySpec desKeySpec = <span class="keyword">new</span> DESedeKeySpec(bytesKey);</span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"DESede"</span>);</span><br><span class="line">			Key convertSecretKey = factory.generateSecret(desKeySpec);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DESede/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk 3des encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, convertSecretKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"jdk 3des decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bc3DES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"DESede"</span>, <span class="string">"BC"</span>);</span><br><span class="line">			keyGenerator.getProvider();</span><br><span class="line">			keyGenerator.init(<span class="number">168</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] bytesKey = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			DESedeKeySpec desKeySpec = <span class="keyword">new</span> DESedeKeySpec(bytesKey);</span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"DESede"</span>);</span><br><span class="line">			Key convertSecretKey = factory.generateSecret(desKeySpec);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DESede/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, convertSecretKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc 3des encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, convertSecretKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"bc 3des decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>AES是目前使用最多的对称加密算法</li>
<li>AES的优势之一是至今尚未被破解</li>
<li>AES通常用于移动通信系统加密以及基于SSH协议的软件(SSH Client、secureCRT)</li>
</ul>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/26.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/26.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AESTest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"aes test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkAES();</span><br><span class="line">		bcAES();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkAES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"AES"</span>);			</span><br><span class="line">			keyGenerator.init(<span class="number">128</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] keyBytes = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			Key key = <span class="keyword">new</span> SecretKeySpec(keyBytes, <span class="string">"AES"</span>);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"AES/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, key);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk aes encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"jdk aes decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 用bouncy castle实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bcAES</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			Security.addProvider(<span class="keyword">new</span> BouncyCastleProvider());</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 生成KEY</span></span><br><span class="line">			KeyGenerator keyGenerator = KeyGenerator.getInstance(<span class="string">"AES"</span>, <span class="string">"BC"</span>);	</span><br><span class="line">			keyGenerator.getProvider();</span><br><span class="line">			keyGenerator.init(<span class="number">128</span>);</span><br><span class="line">			<span class="comment">// 产生密钥</span></span><br><span class="line">			SecretKey secretKey = keyGenerator.generateKey();</span><br><span class="line">			<span class="comment">// 获取密钥</span></span><br><span class="line">			<span class="keyword">byte</span>[] keyBytes = secretKey.getEncoded();</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// KEY转换</span></span><br><span class="line">			Key key = <span class="keyword">new</span> SecretKeySpec(keyBytes, <span class="string">"AES"</span>);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"AES/ECB/PKCS5Padding"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, key);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc aes encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"bc aes decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/27.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/27.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/39.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/39.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/40.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/40.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/41.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/41.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/42.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/42.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/43.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/43.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.SecureRandom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.PBEKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.PBEParameterSpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Hex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PBETest</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"pbe test"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkPBE();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 用jdk实现:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkPBE</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 初始化盐</span></span><br><span class="line">			SecureRandom random = <span class="keyword">new</span> SecureRandom();</span><br><span class="line">			<span class="keyword">byte</span>[] salt = random.generateSeed(<span class="number">8</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 口令与密钥</span></span><br><span class="line">			String password = <span class="string">"timliu"</span>;</span><br><span class="line">			PBEKeySpec pbeKeySpec = <span class="keyword">new</span> PBEKeySpec(password.toCharArray()); </span><br><span class="line">			SecretKeyFactory factory = SecretKeyFactory.getInstance(<span class="string">"PBEWITHMD5andDES"</span>);</span><br><span class="line">			Key key = factory.generateSecret(pbeKeySpec);</span><br><span class="line">			</span><br><span class="line">									</span><br><span class="line">			<span class="comment">// 加密</span></span><br><span class="line">			PBEParameterSpec pbeParameterSpac = <span class="keyword">new</span> PBEParameterSpec(salt, <span class="number">100</span>);</span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"PBEWITHMD5andDES"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, key, pbeParameterSpac);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"jdk pbe encrypt:"</span> + Hex.encodeHexString(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, key, pbeParameterSpac);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"jdk pbe decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Java实现非对称加密"><a href="#Java实现非对称加密" class="headerlink" title="Java实现非对称加密"></a>Java实现非对称加密</h2><div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/44.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/44.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/45.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/45.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/46.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/46.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/47.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/47.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/48.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/48.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/49.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/49.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/50.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/50.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/51.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/51.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/52.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/52.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/53.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/53.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/54.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/54.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/55.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/55.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/56.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/56.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/57.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/57.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/58.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/58.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/59.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/59.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyAgreement;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.interfaces.DHPublicKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DHParameterSpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.utils.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DHTest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"dh test"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkDH();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// jdk实现：</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkDH</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;		</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 1.初始化发送方密钥</span></span><br><span class="line">			KeyPairGenerator senderKeyPairGenerator = KeyPairGenerator.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			senderKeyPairGenerator.initialize(<span class="number">512</span>);</span><br><span class="line">			KeyPair senderKeyPair = senderKeyPairGenerator.generateKeyPair();</span><br><span class="line">			<span class="comment">// 发送方公钥，发送给接收方（网络、文件。。。）</span></span><br><span class="line">			<span class="keyword">byte</span>[] senderPublicKeyEnc = senderKeyPair.getPublic().getEncoded();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 2.初始化接收方密钥</span></span><br><span class="line">			KeyFactory receiverKeyFactory = KeyFactory.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			X509EncodedKeySpec x509EncodedKeySpec = <span class="keyword">new</span> X509EncodedKeySpec(senderPublicKeyEnc);</span><br><span class="line">			PublicKey receiverPublicKey = receiverKeyFactory.generatePublic(x509EncodedKeySpec);</span><br><span class="line">			DHParameterSpec dhParameterSpec = ((DHPublicKey) receiverPublicKey).getParams();</span><br><span class="line">			KeyPairGenerator receiverKeyPairGenerator = KeyPairGenerator.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			receiverKeyPairGenerator.initialize(dhParameterSpec);</span><br><span class="line">			KeyPair receiverKeypair = receiverKeyPairGenerator.generateKeyPair();</span><br><span class="line">			PrivateKey receiverPrivateKey = receiverKeypair.getPrivate();</span><br><span class="line">			<span class="keyword">byte</span>[] receiverPublicKeyEnc = receiverKeypair.getPublic().getEncoded();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 3.密钥构建</span></span><br><span class="line">			KeyAgreement receiverKeyAgreement = KeyAgreement.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			receiverKeyAgreement.init(receiverPrivateKey);</span><br><span class="line">			receiverKeyAgreement.doPhase(receiverPublicKey, <span class="keyword">true</span>);</span><br><span class="line">			SecretKey receiverDesKey = receiverKeyAgreement.generateSecret(<span class="string">"DES"</span>);</span><br><span class="line">			</span><br><span class="line">			KeyFactory senderKeyFactory = KeyFactory.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			x509EncodedKeySpec = <span class="keyword">new</span> X509EncodedKeySpec(receiverPublicKeyEnc);</span><br><span class="line">			PublicKey senderPublicKey = senderKeyFactory.generatePublic(x509EncodedKeySpec);</span><br><span class="line">			KeyAgreement senderKeyAgreement = KeyAgreement.getInstance(<span class="string">"DH"</span>);</span><br><span class="line">			senderKeyAgreement.init(senderKeyPair.getPrivate());</span><br><span class="line">			senderKeyAgreement.doPhase(senderPublicKey, <span class="keyword">true</span>);</span><br><span class="line">			SecretKey senderDesKey = senderKeyAgreement.generateSecret(<span class="string">"DES"</span>);</span><br><span class="line">			<span class="keyword">if</span>(Objects.equals(receiverDesKey, senderDesKey))</span><br><span class="line">			&#123;</span><br><span class="line">				System.out.println(<span class="string">"双方密钥相同。"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 4.加密</span></span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"DES"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, senderDesKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"bc dh encrypt:"</span> + Base64.encodeBase64String(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 5.解密</span></span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, receiverDesKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"bc dh decrypt:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;			</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/60.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/60.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/61.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/61.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/62.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/62.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.RSAPrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.RSAPublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.KeyAgreement;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.interfaces.DHPublicKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DHParameterSpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.utils.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RSATest</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String src = <span class="string">"rsa test"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		jdkRSA();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// jdk实现：</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">jdkRSA</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;		</span><br><span class="line">		<span class="keyword">try</span> </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 1.初始化发送方密钥</span></span><br><span class="line">			KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			keyPairGenerator.initialize(<span class="number">512</span>);</span><br><span class="line">			KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br><span class="line">			RSAPublicKey rsaPublicKey = (RSAPublicKey) keyPair.getPublic();</span><br><span class="line">			RSAPrivateKey rsaPrivateKey = (RSAPrivateKey) keyPair.getPrivate();</span><br><span class="line">			System.out.println(<span class="string">"Public Key:"</span> + Base64.encodeBase64String(rsaPublicKey.getEncoded()));</span><br><span class="line">			System.out.println(<span class="string">"Private Key:"</span> + Base64.encodeBase64String(rsaPrivateKey.getEncoded()));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 2.私钥加密、公钥解密 ---- 加密</span></span><br><span class="line">			PKCS8EncodedKeySpec pkcs8EncodedKeySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(rsaPrivateKey.getEncoded());</span><br><span class="line">			KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			PrivateKey privateKey = keyFactory.generatePrivate(pkcs8EncodedKeySpec);</span><br><span class="line">			Cipher cipher = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			cipher.init(Cipher.ENCRYPT_MODE, privateKey);</span><br><span class="line">			<span class="keyword">byte</span>[] result = cipher.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"私钥加密、公钥解密 ---- 加密:"</span> + Base64.encodeBase64String(result));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 3.私钥加密、公钥解密 ---- 解密</span></span><br><span class="line">			X509EncodedKeySpec x509EncodedKeySpec = <span class="keyword">new</span> X509EncodedKeySpec(rsaPublicKey.getEncoded());</span><br><span class="line">			keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			PublicKey publicKey = keyFactory.generatePublic(x509EncodedKeySpec);</span><br><span class="line">			cipher = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			cipher.init(Cipher.DECRYPT_MODE, publicKey);</span><br><span class="line">			result = cipher.doFinal(result);</span><br><span class="line">			System.out.println(<span class="string">"私钥加密、公钥解密 ---- 解密:"</span> + <span class="keyword">new</span> String(result));</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 4.公钥加密、私钥解密 ---- 加密</span></span><br><span class="line">			X509EncodedKeySpec x509EncodedKeySpec2 = <span class="keyword">new</span> X509EncodedKeySpec(rsaPublicKey.getEncoded());</span><br><span class="line">			KeyFactory keyFactory2 = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			PublicKey publicKey2 = keyFactory2.generatePublic(x509EncodedKeySpec2);</span><br><span class="line">			Cipher cipher2 = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			cipher2.init(Cipher.ENCRYPT_MODE, publicKey2);</span><br><span class="line">			<span class="keyword">byte</span>[] result2 = cipher2.doFinal(src.getBytes());</span><br><span class="line">			System.out.println(<span class="string">"公钥加密、私钥解密 ---- 加密:"</span> + Base64.encodeBase64String(result2));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 5.私钥解密、公钥加密 ---- 解密</span></span><br><span class="line">			PKCS8EncodedKeySpec pkcs8EncodedKeySpec5 = <span class="keyword">new</span> PKCS8EncodedKeySpec(rsaPrivateKey.getEncoded());</span><br><span class="line">			KeyFactory keyFactory5 = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			PrivateKey privateKey5 = keyFactory5.generatePrivate(pkcs8EncodedKeySpec5);</span><br><span class="line">			Cipher cipher5 = Cipher.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">			cipher5.init(Cipher.DECRYPT_MODE, privateKey5);</span><br><span class="line">			<span class="keyword">byte</span>[] result5 = cipher5.doFinal(result2);</span><br><span class="line">			System.out.println(<span class="string">"公钥加密、私钥解密 ---- 解密:"</span> + <span class="keyword">new</span> String(result5));</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/62.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/62.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/63.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/63.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/64.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/64.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/65.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/65.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/66.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/66.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<div class="figure center" style="width:100%;"><a class="fancybox" href="/assets/加密/JAVA实现对称加密/67.jpg" title="" data-caption="" data-fancybox="travel"><img class="fig-img" src="/assets/加密/JAVA实现对称加密/67.jpg" style="width:100%;height:100%;" alt=""></a></div><div style="clear:both;"></div>
<p>参考：<br><a href="https://github.com/Tim9Liu9/java_security" target="_blank" rel="noopener">https://github.com/Tim9Liu9/java_security</a></p>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/加密/">加密</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2020/08/12/云析学院-原生JDK线程扩展-Guava/" data-tooltip="原生JDK线程扩展-Guava" aria-label="下一篇: 原生JDK线程扩展-Guava">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2020/08/19/JAVA加解密/" title="分享到 Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2020/08/19/JAVA加解密/" title="分享到 Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://yoursite.com/2020/08/19/JAVA加解密/" title="分享到 Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 Brotherc. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2020/08/12/云析学院-原生JDK线程扩展-Guava/" data-tooltip="原生JDK线程扩展-Guava" aria-label="下一篇: 原生JDK线程扩展-Guava">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Diesen Beitrag teilen">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2020/08/19/JAVA加解密/" title="分享到 Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2020/08/19/JAVA加解密/" title="分享到 Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://yoursite.com/2020/08/19/JAVA加解密/" title="分享到 Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2020/08/19/JAVA加解密/">
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>分享到 Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2020/08/19/JAVA加解密/">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>分享到 Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://yoursite.com/2020/08/19/JAVA加解密/">
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>分享到 Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/head.jpg" alt="作者的图片">
        
            <h4 id="about-card-name">Brotherc</h4>
        
            <div id="about-card-bio"><p>java development</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>java</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br>
                zhuhai
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-dbd16rvloemmuxdzniplmnxxvwoz24eya9wol0b7vvmlokgqsjivmb8dnscy.min.js"></script>
<!--SCRIPTS END-->

    



    </body>
</html>
